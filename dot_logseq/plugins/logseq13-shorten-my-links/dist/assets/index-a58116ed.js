(function(){const E=document.createElement("link").relList;if(E&&E.supports&&E.supports("modulepreload"))return;for(const z of document.querySelectorAll('link[rel="modulepreload"]'))V(z);new MutationObserver(z=>{for(const Z of z)if(Z.type==="childList")for(const I of Z.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&V(I)}).observe(document,{childList:!0,subtree:!0});function W(z){const Z={};return z.integrity&&(Z.integrity=z.integrity),z.referrerPolicy&&(Z.referrerPolicy=z.referrerPolicy),z.crossOrigin==="use-credentials"?Z.credentials="include":z.crossOrigin==="anonymous"?Z.credentials="omit":Z.credentials="same-origin",Z}function V(z){if(z.ep)return;z.ep=!0;const Z=W(z);fetch(z.href,Z)}})();var Nn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Fn={exports:{}};/*! For license information please see lsplugin.user.js.LICENSE.txt */Fn.exports;(function(x,E){(function(W,V){x.exports=V()})(self,()=>(()=>{var W={227:(I,f,O)=>{var w=O(155);f.formatArgs=function(A){if(A[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+A[0]+(this.useColors?"%c ":" ")+"+"+I.exports.humanize(this.diff),!this.useColors)return;const X="color: "+this.color;A.splice(1,0,X,"color: inherit");let y=0,p=0;A[0].replace(/%[a-zA-Z%]/g,v=>{v!=="%%"&&(y++,v==="%c"&&(p=y))}),A.splice(p,0,X)},f.save=function(A){try{A?f.storage.setItem("debug",A):f.storage.removeItem("debug")}catch{}},f.load=function(){let A;try{A=f.storage.getItem("debug")}catch{}return!A&&w!==void 0&&"env"in w&&(A=w.env.DEBUG),A},f.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},f.storage=function(){try{return localStorage}catch{}}(),f.destroy=(()=>{let A=!1;return()=>{A||(A=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),f.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],f.log=console.debug||console.log||(()=>{}),I.exports=O(447)(f);const{formatters:m}=I.exports;m.j=function(A){try{return JSON.stringify(A)}catch(X){return"[UnexpectedJSONParseError]: "+X.message}}},447:(I,f,O)=>{I.exports=function(w){function m(y){let p,v,b,$=null;function P(...q){if(!P.enabled)return;const J=P,N=Number(new Date),R=N-(p||N);J.diff=R,J.prev=p,J.curr=N,p=N,q[0]=m.coerce(q[0]),typeof q[0]!="string"&&q.unshift("%O");let s=0;q[0]=q[0].replace(/%([a-zA-Z%])/g,(c,g)=>{if(c==="%%")return"%";s++;const j=m.formatters[g];if(typeof j=="function"){const K=q[s];c=j.call(J,K),q.splice(s,1),s--}return c}),m.formatArgs.call(J,q),(J.log||m.log).apply(J,q)}return P.namespace=y,P.useColors=m.useColors(),P.color=m.selectColor(y),P.extend=A,P.destroy=m.destroy,Object.defineProperty(P,"enabled",{enumerable:!0,configurable:!1,get:()=>$!==null?$:(v!==m.namespaces&&(v=m.namespaces,b=m.enabled(y)),b),set:q=>{$=q}}),typeof m.init=="function"&&m.init(P),P}function A(y,p){const v=m(this.namespace+(p===void 0?":":p)+y);return v.log=this.log,v}function X(y){return y.toString().substring(2,y.toString().length-2).replace(/\.\*\?$/,"*")}return m.debug=m,m.default=m,m.coerce=function(y){return y instanceof Error?y.stack||y.message:y},m.disable=function(){const y=[...m.names.map(X),...m.skips.map(X).map(p=>"-"+p)].join(",");return m.enable(""),y},m.enable=function(y){let p;m.save(y),m.namespaces=y,m.names=[],m.skips=[];const v=(typeof y=="string"?y:"").split(/[\s,]+/),b=v.length;for(p=0;p<b;p++)v[p]&&((y=v[p].replace(/\*/g,".*?"))[0]==="-"?m.skips.push(new RegExp("^"+y.slice(1)+"$")):m.names.push(new RegExp("^"+y+"$")))},m.enabled=function(y){if(y[y.length-1]==="*")return!0;let p,v;for(p=0,v=m.skips.length;p<v;p++)if(m.skips[p].test(y))return!1;for(p=0,v=m.names.length;p<v;p++)if(m.names[p].test(y))return!0;return!1},m.humanize=O(824),m.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(w).forEach(y=>{m[y]=w[y]}),m.names=[],m.skips=[],m.formatters={},m.selectColor=function(y){let p=0;for(let v=0;v<y.length;v++)p=(p<<5)-p+y.charCodeAt(v),p|=0;return m.colors[Math.abs(p)%m.colors.length]},m.enable(m.load()),m}},856:function(I){I.exports=function(){function f(S){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},f(S)}function O(S,T){return O=Object.setPrototypeOf||function(B,ee){return B.__proto__=ee,B},O(S,T)}function w(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m(S,T,B){return m=w()?Reflect.construct:function(ee,ce,Me){var Ke=[null];Ke.push.apply(Ke,ce);var Pe=new(Function.bind.apply(ee,Ke));return Me&&O(Pe,Me.prototype),Pe},m.apply(null,arguments)}function A(S){return X(S)||y(S)||p(S)||b()}function X(S){if(Array.isArray(S))return v(S)}function y(S){if(typeof Symbol<"u"&&S[Symbol.iterator]!=null||S["@@iterator"]!=null)return Array.from(S)}function p(S,T){if(S){if(typeof S=="string")return v(S,T);var B=Object.prototype.toString.call(S).slice(8,-1);return B==="Object"&&S.constructor&&(B=S.constructor.name),B==="Map"||B==="Set"?Array.from(S):B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B)?v(S,T):void 0}}function v(S,T){(T==null||T>S.length)&&(T=S.length);for(var B=0,ee=new Array(T);B<T;B++)ee[B]=S[B];return ee}function b(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var $=Object.hasOwnProperty,P=Object.setPrototypeOf,q=Object.isFrozen,J=Object.getPrototypeOf,N=Object.getOwnPropertyDescriptor,R=Object.freeze,s=Object.seal,c=Object.create,g=typeof Reflect<"u"&&Reflect,j=g.apply,K=g.construct;j||(j=function(S,T,B){return S.apply(T,B)}),R||(R=function(S){return S}),s||(s=function(S){return S}),K||(K=function(S,T){return m(S,A(T))});var ne=oe(Array.prototype.forEach),ae=oe(Array.prototype.pop),me=oe(Array.prototype.push),xe=oe(String.prototype.toLowerCase),Ce=oe(String.prototype.match),pe=oe(String.prototype.replace),Ne=oe(String.prototype.indexOf),d=oe(String.prototype.trim),_=oe(RegExp.prototype.test),D=Se(TypeError);function oe(S){return function(T){for(var B=arguments.length,ee=new Array(B>1?B-1:0),ce=1;ce<B;ce++)ee[ce-1]=arguments[ce];return j(S,T,ee)}}function Se(S){return function(){for(var T=arguments.length,B=new Array(T),ee=0;ee<T;ee++)B[ee]=arguments[ee];return K(S,B)}}function U(S,T){P&&P(S,null);for(var B=T.length;B--;){var ee=T[B];if(typeof ee=="string"){var ce=xe(ee);ce!==ee&&(q(T)||(T[B]=ce),ee=ce)}S[ee]=!0}return S}function Y(S){var T,B=c(null);for(T in S)j($,S,[T])&&(B[T]=S[T]);return B}function ue(S,T){for(;S!==null;){var B=N(S,T);if(B){if(B.get)return oe(B.get);if(typeof B.value=="function")return oe(B.value)}S=J(S)}function ee(ce){return console.warn("fallback value for",ce),null}return ee}var Ae=R(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Oe=R(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),He=R(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),nt=R(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),he=R(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),fe=R(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ee=R(["#text"]),ke=R(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Te=R(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Fe=R(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),De=R(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Mt=s(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ct=s(/<%[\w\W]*|[\w\W]*%>/gm),Pn=s(/^data-[\-\w.\u00B7-\uFFFF]/),Rn=s(/^aria-[\-\w]+$/),Dn=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Un=s(/^(?:\w+script|data):/i),rt=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ln=s(/^html$/i),zn=function(){return typeof window>"u"?null:window},$n=function(S,T){if(f(S)!=="object"||typeof S.createPolicy!="function")return null;var B=null,ee="data-tt-policy-suffix";T.currentScript&&T.currentScript.hasAttribute(ee)&&(B=T.currentScript.getAttribute(ee));var ce="dompurify"+(B?"#"+B:"");try{return S.createPolicy(ce,{createHTML:function(Me){return Me}})}catch{return console.warn("TrustedTypes policy "+ce+" could not be created."),null}};function ft(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zn(),T=function(o){return ft(o)};if(T.version="2.3.8",T.removed=[],!S||!S.document||S.document.nodeType!==9)return T.isSupported=!1,T;var B=S.document,ee=S.document,ce=S.DocumentFragment,Me=S.HTMLTemplateElement,Ke=S.Node,Pe=S.Element,Ye=S.NodeFilter,dt=S.NamedNodeMap,St=dt===void 0?S.NamedNodeMap||S.MozNamedAttrMap:dt,Pt=S.HTMLFormElement,un=S.DOMParser,fn=S.trustedTypes,pt=Pe.prototype,dn=ue(pt,"cloneNode"),pn=ue(pt,"nextSibling"),qn=ue(pt,"childNodes"),ot=ue(pt,"parentNode");if(typeof Me=="function"){var Rt=ee.createElement("template");Rt.content&&Rt.content.ownerDocument&&(ee=Rt.content.ownerDocument)}var Be=$n(fn,B),hn=Be?Be.createHTML(""):"",ht=ee,Dt=ht.implementation,gn=ht.createNodeIterator,mn=ht.createDocumentFragment,Hn=ht.getElementsByTagName,Ut=B.importNode,vn={};try{vn=Y(ee).documentMode?ee.documentMode:{}}catch{}var be={};T.isSupported=typeof ot=="function"&&Dt&&Dt.createHTMLDocument!==void 0&&vn!==9;var it,We,zt=Mt,$t=Ct,Ot=Pn,Ie=Rn,qt=Un,gt=rt,Ht=Dn,ve=null,Bt=U({},[].concat(A(Ae),A(Oe),A(He),A(he),A(Ee))),ye=null,Wt=U({},[].concat(A(ke),A(Te),A(Fe),A(De))),le=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),mt=null,Gt=null,Jt=!0,Vt=!0,yn=!1,st=!1,re=!1,Zt=!1,Kt=!1,Qe=!1,Ge=!1,at=!1,Yt=!0,Et=!0,Xe=!1,Je={},ct=null,bn=U({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),_n=null,wn=U({},["audio","video","img","source","image","track"]),Qt=null,kt=U({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Xt="http://www.w3.org/1998/Math/MathML",At="http://www.w3.org/2000/svg",Ve="http://www.w3.org/1999/xhtml",jt=Ve,xn=!1,Cn=["application/xhtml+xml","text/html"],Bn="text/html",lt=null,Wn=ee.createElement("form"),Tt=function(o){return o instanceof RegExp||o instanceof Function},en=function(o){lt&&lt===o||(o&&f(o)==="object"||(o={}),o=Y(o),ve="ALLOWED_TAGS"in o?U({},o.ALLOWED_TAGS):Bt,ye="ALLOWED_ATTR"in o?U({},o.ALLOWED_ATTR):Wt,Qt="ADD_URI_SAFE_ATTR"in o?U(Y(kt),o.ADD_URI_SAFE_ATTR):kt,_n="ADD_DATA_URI_TAGS"in o?U(Y(wn),o.ADD_DATA_URI_TAGS):wn,ct="FORBID_CONTENTS"in o?U({},o.FORBID_CONTENTS):bn,mt="FORBID_TAGS"in o?U({},o.FORBID_TAGS):{},Gt="FORBID_ATTR"in o?U({},o.FORBID_ATTR):{},Je="USE_PROFILES"in o&&o.USE_PROFILES,Jt=o.ALLOW_ARIA_ATTR!==!1,Vt=o.ALLOW_DATA_ATTR!==!1,yn=o.ALLOW_UNKNOWN_PROTOCOLS||!1,st=o.SAFE_FOR_TEMPLATES||!1,re=o.WHOLE_DOCUMENT||!1,Qe=o.RETURN_DOM||!1,Ge=o.RETURN_DOM_FRAGMENT||!1,at=o.RETURN_TRUSTED_TYPE||!1,Kt=o.FORCE_BODY||!1,Yt=o.SANITIZE_DOM!==!1,Et=o.KEEP_CONTENT!==!1,Xe=o.IN_PLACE||!1,Ht=o.ALLOWED_URI_REGEXP||Ht,jt=o.NAMESPACE||Ve,o.CUSTOM_ELEMENT_HANDLING&&Tt(o.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(le.tagNameCheck=o.CUSTOM_ELEMENT_HANDLING.tagNameCheck),o.CUSTOM_ELEMENT_HANDLING&&Tt(o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(le.attributeNameCheck=o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),o.CUSTOM_ELEMENT_HANDLING&&typeof o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(le.allowCustomizedBuiltInElements=o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),it=it=Cn.indexOf(o.PARSER_MEDIA_TYPE)===-1?Bn:o.PARSER_MEDIA_TYPE,We=it==="application/xhtml+xml"?function(k){return k}:xe,st&&(Vt=!1),Ge&&(Qe=!0),Je&&(ve=U({},A(Ee)),ye=[],Je.html===!0&&(U(ve,Ae),U(ye,ke)),Je.svg===!0&&(U(ve,Oe),U(ye,Te),U(ye,De)),Je.svgFilters===!0&&(U(ve,He),U(ye,Te),U(ye,De)),Je.mathMl===!0&&(U(ve,he),U(ye,Fe),U(ye,De))),o.ADD_TAGS&&(ve===Bt&&(ve=Y(ve)),U(ve,o.ADD_TAGS)),o.ADD_ATTR&&(ye===Wt&&(ye=Y(ye)),U(ye,o.ADD_ATTR)),o.ADD_URI_SAFE_ATTR&&U(Qt,o.ADD_URI_SAFE_ATTR),o.FORBID_CONTENTS&&(ct===bn&&(ct=Y(ct)),U(ct,o.FORBID_CONTENTS)),Et&&(ve["#text"]=!0),re&&U(ve,["html","head","body"]),ve.table&&(U(ve,["tbody"]),delete mt.tbody),R&&R(o),lt=o)},tn=U({},["mi","mo","mn","ms","mtext"]),Sn=U({},["foreignobject","desc","title","annotation-xml"]),Gn=U({},["title","style","font","a","script"]),It=U({},Oe);U(It,He),U(It,nt);var nn=U({},he);U(nn,fe);var Jn=function(o){var k=ot(o);k&&k.tagName||(k={namespaceURI:Ve,tagName:"template"});var C=xe(o.tagName),ie=xe(k.tagName);return o.namespaceURI===At?k.namespaceURI===Ve?C==="svg":k.namespaceURI===Xt?C==="svg"&&(ie==="annotation-xml"||tn[ie]):!!It[C]:o.namespaceURI===Xt?k.namespaceURI===Ve?C==="math":k.namespaceURI===At?C==="math"&&Sn[ie]:!!nn[C]:o.namespaceURI===Ve&&!(k.namespaceURI===At&&!Sn[ie])&&!(k.namespaceURI===Xt&&!tn[ie])&&!nn[C]&&(Gn[C]||!It[C])},Ue=function(o){me(T.removed,{element:o});try{o.parentNode.removeChild(o)}catch{try{o.outerHTML=hn}catch{o.remove()}}},On=function(o,k){try{me(T.removed,{attribute:k.getAttributeNode(o),from:k})}catch{me(T.removed,{attribute:null,from:k})}if(k.removeAttribute(o),o==="is"&&!ye[o])if(Qe||Ge)try{Ue(k)}catch{}else try{k.setAttribute(o,"")}catch{}},En=function(o){var k,C;if(Kt)o="<remove></remove>"+o;else{var ie=Ce(o,/^[\r\n\t ]+/);C=ie&&ie[0]}it==="application/xhtml+xml"&&(o='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+o+"</body></html>");var de=Be?Be.createHTML(o):o;if(jt===Ve)try{k=new un().parseFromString(de,it)}catch{}if(!k||!k.documentElement){k=Dt.createDocument(jt,"template",null);try{k.documentElement.innerHTML=xn?"":de}catch{}}var _e=k.body||k.documentElement;return o&&C&&_e.insertBefore(ee.createTextNode(C),_e.childNodes[0]||null),jt===Ve?Hn.call(k,re?"html":"body")[0]:re?k.documentElement:_e},vt=function(o){return gn.call(o.ownerDocument||o,o,Ye.SHOW_ELEMENT|Ye.SHOW_COMMENT|Ye.SHOW_TEXT,null,!1)},Vn=function(o){return o instanceof Pt&&(typeof o.nodeName!="string"||typeof o.textContent!="string"||typeof o.removeChild!="function"||!(o.attributes instanceof St)||typeof o.removeAttribute!="function"||typeof o.setAttribute!="function"||typeof o.namespaceURI!="string"||typeof o.insertBefore!="function")},yt=function(o){return f(Ke)==="object"?o instanceof Ke:o&&f(o)==="object"&&typeof o.nodeType=="number"&&typeof o.nodeName=="string"},ze=function(o,k,C){be[o]&&ne(be[o],function(ie){ie.call(T,k,C,lt)})},rn=function(o){var k;if(ze("beforeSanitizeElements",o,null),Vn(o)||_(/[\u0080-\uFFFF]/,o.nodeName))return Ue(o),!0;var C=We(o.nodeName);if(ze("uponSanitizeElement",o,{tagName:C,allowedTags:ve}),o.hasChildNodes()&&!yt(o.firstElementChild)&&(!yt(o.content)||!yt(o.content.firstElementChild))&&_(/<[/\w]/g,o.innerHTML)&&_(/<[/\w]/g,o.textContent)||C==="select"&&_(/<template/i,o.innerHTML))return Ue(o),!0;if(!ve[C]||mt[C]){if(!mt[C]&&on(C)&&(le.tagNameCheck instanceof RegExp&&_(le.tagNameCheck,C)||le.tagNameCheck instanceof Function&&le.tagNameCheck(C)))return!1;if(Et&&!ct[C]){var ie=ot(o)||o.parentNode,de=qn(o)||o.childNodes;if(de&&ie)for(var _e=de.length-1;_e>=0;--_e)ie.insertBefore(dn(de[_e],!0),pn(o))}return Ue(o),!0}return o instanceof Pe&&!Jn(o)?(Ue(o),!0):C!=="noscript"&&C!=="noembed"||!_(/<\/no(script|embed)/i,o.innerHTML)?(st&&o.nodeType===3&&(k=o.textContent,k=pe(k,zt," "),k=pe(k,$t," "),o.textContent!==k&&(me(T.removed,{element:o.cloneNode()}),o.textContent=k)),ze("afterSanitizeElements",o,null),!1):(Ue(o),!0)},kn=function(o,k,C){if(Yt&&(k==="id"||k==="name")&&(C in ee||C in Wn))return!1;if(!(Vt&&!Gt[k]&&_(Ot,k))){if(!(Jt&&_(Ie,k))){if(!ye[k]||Gt[k]){if(!(on(o)&&(le.tagNameCheck instanceof RegExp&&_(le.tagNameCheck,o)||le.tagNameCheck instanceof Function&&le.tagNameCheck(o))&&(le.attributeNameCheck instanceof RegExp&&_(le.attributeNameCheck,k)||le.attributeNameCheck instanceof Function&&le.attributeNameCheck(k))||k==="is"&&le.allowCustomizedBuiltInElements&&(le.tagNameCheck instanceof RegExp&&_(le.tagNameCheck,C)||le.tagNameCheck instanceof Function&&le.tagNameCheck(C))))return!1}else if(!Qt[k]){if(!_(Ht,pe(C,gt,""))){if((k!=="src"&&k!=="xlink:href"&&k!=="href"||o==="script"||Ne(C,"data:")!==0||!_n[o])&&!(yn&&!_(qt,pe(C,gt,"")))){if(C)return!1}}}}}return!0},on=function(o){return o.indexOf("-")>0},bt=function(o){var k,C,ie,de;ze("beforeSanitizeAttributes",o,null);var _e=o.attributes;if(_e){var we={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ye};for(de=_e.length;de--;){var _t=k=_e[de],$e=_t.name,te=_t.namespaceURI;if(C=$e==="value"?k.value:d(k.value),ie=We($e),we.attrName=ie,we.attrValue=C,we.keepAttr=!0,we.forceKeepAttr=void 0,ze("uponSanitizeAttribute",o,we),C=we.attrValue,!we.forceKeepAttr&&(On($e,o),we.keepAttr))if(_(/\/>/i,C))On($e,o);else{st&&(C=pe(C,zt," "),C=pe(C,$t," "));var et=We(o.nodeName);if(kn(et,ie,C))try{te?o.setAttributeNS(te,$e,C):o.setAttribute($e,C),ae(T.removed)}catch{}}}ze("afterSanitizeAttributes",o,null)}},sn=function o(k){var C,ie=vt(k);for(ze("beforeSanitizeShadowDOM",k,null);C=ie.nextNode();)ze("uponSanitizeShadowNode",C,null),rn(C)||(C.content instanceof ce&&o(C.content),bt(C));ze("afterSanitizeShadowDOM",k,null)};return T.sanitize=function(o,k){var C,ie,de,_e,we;if((xn=!o)&&(o="<!-->"),typeof o!="string"&&!yt(o)){if(typeof o.toString!="function")throw D("toString is not a function");if(typeof(o=o.toString())!="string")throw D("dirty is not a string, aborting")}if(!T.isSupported){if(f(S.toStaticHTML)==="object"||typeof S.toStaticHTML=="function"){if(typeof o=="string")return S.toStaticHTML(o);if(yt(o))return S.toStaticHTML(o.outerHTML)}return o}if(Zt||en(k),T.removed=[],typeof o=="string"&&(Xe=!1),Xe){if(o.nodeName){var _t=We(o.nodeName);if(!ve[_t]||mt[_t])throw D("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof Ke)(ie=(C=En("<!---->")).ownerDocument.importNode(o,!0)).nodeType===1&&ie.nodeName==="BODY"||ie.nodeName==="HTML"?C=ie:C.appendChild(ie);else{if(!Qe&&!st&&!re&&o.indexOf("<")===-1)return Be&&at?Be.createHTML(o):o;if(!(C=En(o)))return Qe?null:at?hn:""}C&&Kt&&Ue(C.firstChild);for(var $e=vt(Xe?o:C);de=$e.nextNode();)de.nodeType===3&&de===_e||rn(de)||(de.content instanceof ce&&sn(de.content),bt(de),_e=de);if(_e=null,Xe)return o;if(Qe){if(Ge)for(we=mn.call(C.ownerDocument);C.firstChild;)we.appendChild(C.firstChild);else we=C;return ye.shadowroot&&(we=Ut.call(B,we,!0)),we}var te=re?C.outerHTML:C.innerHTML;return re&&ve["!doctype"]&&C.ownerDocument&&C.ownerDocument.doctype&&C.ownerDocument.doctype.name&&_(ln,C.ownerDocument.doctype.name)&&(te="<!DOCTYPE "+C.ownerDocument.doctype.name+`>
`+te),st&&(te=pe(te,zt," "),te=pe(te,$t," ")),Be&&at?Be.createHTML(te):te},T.setConfig=function(o){en(o),Zt=!0},T.clearConfig=function(){lt=null,Zt=!1},T.isValidAttribute=function(o,k,C){lt||en({});var ie=We(o),de=We(k);return kn(ie,de,C)},T.addHook=function(o,k){typeof k=="function"&&(be[o]=be[o]||[],me(be[o],k))},T.removeHook=function(o){if(be[o])return ae(be[o])},T.removeHooks=function(o){be[o]&&(be[o]=[])},T.removeAllHooks=function(){be={}},T}return ft()}()},729:I=>{var f=Object.prototype.hasOwnProperty,O="~";function w(){}function m(p,v,b){this.fn=p,this.context=v,this.once=b||!1}function A(p,v,b,$,P){if(typeof b!="function")throw new TypeError("The listener must be a function");var q=new m(b,$||p,P),J=O?O+v:v;return p._events[J]?p._events[J].fn?p._events[J]=[p._events[J],q]:p._events[J].push(q):(p._events[J]=q,p._eventsCount++),p}function X(p,v){--p._eventsCount==0?p._events=new w:delete p._events[v]}function y(){this._events=new w,this._eventsCount=0}Object.create&&(w.prototype=Object.create(null),new w().__proto__||(O=!1)),y.prototype.eventNames=function(){var p,v,b=[];if(this._eventsCount===0)return b;for(v in p=this._events)f.call(p,v)&&b.push(O?v.slice(1):v);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(p)):b},y.prototype.listeners=function(p){var v=O?O+p:p,b=this._events[v];if(!b)return[];if(b.fn)return[b.fn];for(var $=0,P=b.length,q=new Array(P);$<P;$++)q[$]=b[$].fn;return q},y.prototype.listenerCount=function(p){var v=O?O+p:p,b=this._events[v];return b?b.fn?1:b.length:0},y.prototype.emit=function(p,v,b,$,P,q){var J=O?O+p:p;if(!this._events[J])return!1;var N,R,s=this._events[J],c=arguments.length;if(s.fn){switch(s.once&&this.removeListener(p,s.fn,void 0,!0),c){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,v),!0;case 3:return s.fn.call(s.context,v,b),!0;case 4:return s.fn.call(s.context,v,b,$),!0;case 5:return s.fn.call(s.context,v,b,$,P),!0;case 6:return s.fn.call(s.context,v,b,$,P,q),!0}for(R=1,N=new Array(c-1);R<c;R++)N[R-1]=arguments[R];s.fn.apply(s.context,N)}else{var g,j=s.length;for(R=0;R<j;R++)switch(s[R].once&&this.removeListener(p,s[R].fn,void 0,!0),c){case 1:s[R].fn.call(s[R].context);break;case 2:s[R].fn.call(s[R].context,v);break;case 3:s[R].fn.call(s[R].context,v,b);break;case 4:s[R].fn.call(s[R].context,v,b,$);break;default:if(!N)for(g=1,N=new Array(c-1);g<c;g++)N[g-1]=arguments[g];s[R].fn.apply(s[R].context,N)}}return!0},y.prototype.on=function(p,v,b){return A(this,p,v,b,!1)},y.prototype.once=function(p,v,b){return A(this,p,v,b,!0)},y.prototype.removeListener=function(p,v,b,$){var P=O?O+p:p;if(!this._events[P])return this;if(!v)return X(this,P),this;var q=this._events[P];if(q.fn)q.fn!==v||$&&!q.once||b&&q.context!==b||X(this,P);else{for(var J=0,N=[],R=q.length;J<R;J++)(q[J].fn!==v||$&&!q[J].once||b&&q[J].context!==b)&&N.push(q[J]);N.length?this._events[P]=N.length===1?N[0]:N:X(this,P)}return this},y.prototype.removeAllListeners=function(p){var v;return p?(v=O?O+p:p,this._events[v]&&X(this,v)):(this._events=new w,this._eventsCount=0),this},y.prototype.off=y.prototype.removeListener,y.prototype.addListener=y.prototype.on,y.prefixed=O,y.EventEmitter=y,I.exports=y},717:I=>{typeof Object.create=="function"?I.exports=function(f,O){f.super_=O,f.prototype=Object.create(O.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:I.exports=function(f,O){f.super_=O;var w=function(){};w.prototype=O.prototype,f.prototype=new w,f.prototype.constructor=f}},824:I=>{var f=1e3,O=60*f,w=60*O,m=24*w,A=7*m,X=365.25*m;function y(p,v,b,$){var P=v>=1.5*b;return Math.round(p/b)+" "+$+(P?"s":"")}I.exports=function(p,v){v=v||{};var b=typeof p;if(b==="string"&&p.length>0)return function($){if(!(($=String($)).length>100)){var P=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec($);if(P){var q=parseFloat(P[1]);switch((P[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return q*X;case"weeks":case"week":case"w":return q*A;case"days":case"day":case"d":return q*m;case"hours":case"hour":case"hrs":case"hr":case"h":return q*w;case"minutes":case"minute":case"mins":case"min":case"m":return q*O;case"seconds":case"second":case"secs":case"sec":case"s":return q*f;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return q;default:return}}}}(p);if(b==="number"&&isFinite(p))return v.long?function($){var P=Math.abs($);return P>=m?y($,P,m,"day"):P>=w?y($,P,w,"hour"):P>=O?y($,P,O,"minute"):P>=f?y($,P,f,"second"):$+" ms"}(p):function($){var P=Math.abs($);return P>=m?Math.round($/m)+"d":P>=w?Math.round($/w)+"h":P>=O?Math.round($/O)+"m":P>=f?Math.round($/f)+"s":$+"ms"}(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))}},520:(I,f,O)=>{var w=O(155),m=w.platform==="win32",A=O(539);function X(s,c){for(var g=[],j=0;j<s.length;j++){var K=s[j];K&&K!=="."&&(K===".."?g.length&&g[g.length-1]!==".."?g.pop():c&&g.push(".."):g.push(K))}return g}function y(s){for(var c=s.length-1,g=0;g<=c&&!s[g];g++);for(var j=c;j>=0&&!s[j];j--);return g===0&&j===c?s:g>j?[]:s.slice(g,j+1)}var p=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,v=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,b={};function $(s){var c=p.exec(s),g=(c[1]||"")+(c[2]||""),j=c[3]||"",K=v.exec(j);return[g,K[1],K[2],K[3]]}function P(s){var c=p.exec(s),g=c[1]||"",j=!!g&&g[1]!==":";return{device:g,isUnc:j,isAbsolute:j||!!c[2],tail:c[3]}}function q(s){return"\\\\"+s.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}b.resolve=function(){for(var s="",c="",g=!1,j=arguments.length-1;j>=-1;j--){var K;if(j>=0?K=arguments[j]:s?(K=w.env["="+s])&&K.substr(0,3).toLowerCase()===s.toLowerCase()+"\\"||(K=s+"\\"):K=w.cwd(),!A.isString(K))throw new TypeError("Arguments to path.resolve must be strings");if(K){var ne=P(K),ae=ne.device,me=ne.isUnc,xe=ne.isAbsolute,Ce=ne.tail;if((!ae||!s||ae.toLowerCase()===s.toLowerCase())&&(s||(s=ae),g||(c=Ce+"\\"+c,g=xe),s&&g))break}}return me&&(s=q(s)),s+(g?"\\":"")+(c=X(c.split(/[\\\/]+/),!g).join("\\"))||"."},b.normalize=function(s){var c=P(s),g=c.device,j=c.isUnc,K=c.isAbsolute,ne=c.tail,ae=/[\\\/]$/.test(ne);return(ne=X(ne.split(/[\\\/]+/),!K).join("\\"))||K||(ne="."),ne&&ae&&(ne+="\\"),j&&(g=q(g)),g+(K?"\\":"")+ne},b.isAbsolute=function(s){return P(s).isAbsolute},b.join=function(){for(var s=[],c=0;c<arguments.length;c++){var g=arguments[c];if(!A.isString(g))throw new TypeError("Arguments to path.join must be strings");g&&s.push(g)}var j=s.join("\\");return/^[\\\/]{2}[^\\\/]/.test(s[0])||(j=j.replace(/^[\\\/]{2,}/,"\\")),b.normalize(j)},b.relative=function(s,c){s=b.resolve(s),c=b.resolve(c);for(var g=s.toLowerCase(),j=c.toLowerCase(),K=y(c.split("\\")),ne=y(g.split("\\")),ae=y(j.split("\\")),me=Math.min(ne.length,ae.length),xe=me,Ce=0;Ce<me;Ce++)if(ne[Ce]!==ae[Ce]){xe=Ce;break}if(xe==0)return c;var pe=[];for(Ce=xe;Ce<ne.length;Ce++)pe.push("..");return(pe=pe.concat(K.slice(xe))).join("\\")},b._makeLong=function(s){if(!A.isString(s))return s;if(!s)return"";var c=b.resolve(s);return/^[a-zA-Z]\:\\/.test(c)?"\\\\?\\"+c:/^\\\\[^?.]/.test(c)?"\\\\?\\UNC\\"+c.substring(2):s},b.dirname=function(s){var c=$(s),g=c[0],j=c[1];return g||j?(j&&(j=j.substr(0,j.length-1)),g+j):"."},b.basename=function(s,c){var g=$(s)[2];return c&&g.substr(-1*c.length)===c&&(g=g.substr(0,g.length-c.length)),g},b.extname=function(s){return $(s)[3]},b.format=function(s){if(!A.isObject(s))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof s);var c=s.root||"";if(!A.isString(c))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof s.root);var g=s.dir,j=s.base||"";return g?g[g.length-1]===b.sep?g+j:g+b.sep+j:j},b.parse=function(s){if(!A.isString(s))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof s);var c=$(s);if(!c||c.length!==4)throw new TypeError("Invalid path '"+s+"'");return{root:c[0],dir:c[0]+c[1].slice(0,-1),base:c[2],ext:c[3],name:c[2].slice(0,c[2].length-c[3].length)}},b.sep="\\",b.delimiter=";";var J=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,N={};function R(s){return J.exec(s).slice(1)}N.resolve=function(){for(var s="",c=!1,g=arguments.length-1;g>=-1&&!c;g--){var j=g>=0?arguments[g]:w.cwd();if(!A.isString(j))throw new TypeError("Arguments to path.resolve must be strings");j&&(s=j+"/"+s,c=j[0]==="/")}return(c?"/":"")+(s=X(s.split("/"),!c).join("/"))||"."},N.normalize=function(s){var c=N.isAbsolute(s),g=s&&s[s.length-1]==="/";return(s=X(s.split("/"),!c).join("/"))||c||(s="."),s&&g&&(s+="/"),(c?"/":"")+s},N.isAbsolute=function(s){return s.charAt(0)==="/"},N.join=function(){for(var s="",c=0;c<arguments.length;c++){var g=arguments[c];if(!A.isString(g))throw new TypeError("Arguments to path.join must be strings");g&&(s+=s?"/"+g:g)}return N.normalize(s)},N.relative=function(s,c){s=N.resolve(s).substr(1),c=N.resolve(c).substr(1);for(var g=y(s.split("/")),j=y(c.split("/")),K=Math.min(g.length,j.length),ne=K,ae=0;ae<K;ae++)if(g[ae]!==j[ae]){ne=ae;break}var me=[];for(ae=ne;ae<g.length;ae++)me.push("..");return(me=me.concat(j.slice(ne))).join("/")},N._makeLong=function(s){return s},N.dirname=function(s){var c=R(s),g=c[0],j=c[1];return g||j?(j&&(j=j.substr(0,j.length-1)),g+j):"."},N.basename=function(s,c){var g=R(s)[2];return c&&g.substr(-1*c.length)===c&&(g=g.substr(0,g.length-c.length)),g},N.extname=function(s){return R(s)[3]},N.format=function(s){if(!A.isObject(s))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof s);var c=s.root||"";if(!A.isString(c))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof s.root);return(s.dir?s.dir+N.sep:"")+(s.base||"")},N.parse=function(s){if(!A.isString(s))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof s);var c=R(s);if(!c||c.length!==4)throw new TypeError("Invalid path '"+s+"'");return c[1]=c[1]||"",c[2]=c[2]||"",c[3]=c[3]||"",{root:c[0],dir:c[0]+c[1].slice(0,-1),base:c[2],ext:c[3],name:c[2].slice(0,c[2].length-c[3].length)}},N.sep="/",N.delimiter=":",I.exports=m?b:N,I.exports.posix=N,I.exports.win32=b},155:I=>{var f,O,w=I.exports={};function m(){throw new Error("setTimeout has not been defined")}function A(){throw new Error("clearTimeout has not been defined")}function X(N){if(f===setTimeout)return setTimeout(N,0);if((f===m||!f)&&setTimeout)return f=setTimeout,setTimeout(N,0);try{return f(N,0)}catch{try{return f.call(null,N,0)}catch{return f.call(this,N,0)}}}(function(){try{f=typeof setTimeout=="function"?setTimeout:m}catch{f=m}try{O=typeof clearTimeout=="function"?clearTimeout:A}catch{O=A}})();var y,p=[],v=!1,b=-1;function $(){v&&y&&(v=!1,y.length?p=y.concat(p):b=-1,p.length&&P())}function P(){if(!v){var N=X($);v=!0;for(var R=p.length;R;){for(y=p,p=[];++b<R;)y&&y[b].run();b=-1,R=p.length}y=null,v=!1,function(s){if(O===clearTimeout)return clearTimeout(s);if((O===A||!O)&&clearTimeout)return O=clearTimeout,clearTimeout(s);try{O(s)}catch{try{return O.call(null,s)}catch{return O.call(this,s)}}}(N)}}function q(N,R){this.fun=N,this.array=R}function J(){}w.nextTick=function(N){var R=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)R[s-1]=arguments[s];p.push(new q(N,R)),p.length!==1||v||X(P)},q.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={},w.on=J,w.addListener=J,w.once=J,w.off=J,w.removeListener=J,w.removeAllListeners=J,w.emit=J,w.prependListener=J,w.prependOnceListener=J,w.listeners=function(N){return[]},w.binding=function(N){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(N){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},384:I=>{I.exports=function(f){return f&&typeof f=="object"&&typeof f.copy=="function"&&typeof f.fill=="function"&&typeof f.readUInt8=="function"}},539:(I,f,O)=>{var w=O(155),m=/%[sdj%]/g;f.format=function(d){if(!s(d)){for(var _=[],D=0;D<arguments.length;D++)_.push(y(arguments[D]));return _.join(" ")}D=1;for(var oe=arguments,Se=oe.length,U=String(d).replace(m,function(ue){if(ue==="%%")return"%";if(D>=Se)return ue;switch(ue){case"%s":return String(oe[D++]);case"%d":return Number(oe[D++]);case"%j":try{return JSON.stringify(oe[D++])}catch{return"[Circular]"}default:return ue}}),Y=oe[D];D<Se;Y=oe[++D])N(Y)||!j(Y)?U+=" "+Y:U+=" "+y(Y);return U},f.deprecate=function(d,_){if(c(O.g.process))return function(){return f.deprecate(d,_).apply(this,arguments)};if(w.noDeprecation===!0)return d;var D=!1;return function(){if(!D){if(w.throwDeprecation)throw new Error(_);w.traceDeprecation?console.trace(_):console.error(_),D=!0}return d.apply(this,arguments)}};var A,X={};function y(d,_){var D={seen:[],stylize:v};return arguments.length>=3&&(D.depth=arguments[2]),arguments.length>=4&&(D.colors=arguments[3]),J(_)?D.showHidden=_:_&&f._extend(D,_),c(D.showHidden)&&(D.showHidden=!1),c(D.depth)&&(D.depth=2),c(D.colors)&&(D.colors=!1),c(D.customInspect)&&(D.customInspect=!0),D.colors&&(D.stylize=p),b(D,d,D.depth)}function p(d,_){var D=y.styles[_];return D?"\x1B["+y.colors[D][0]+"m"+d+"\x1B["+y.colors[D][1]+"m":d}function v(d,_){return d}function b(d,_,D){if(d.customInspect&&_&&ae(_.inspect)&&_.inspect!==f.inspect&&(!_.constructor||_.constructor.prototype!==_)){var oe=_.inspect(D,d);return s(oe)||(oe=b(d,oe,D)),oe}var Se=function(he,fe){if(c(fe))return he.stylize("undefined","undefined");if(s(fe)){var Ee="'"+JSON.stringify(fe).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return he.stylize(Ee,"string")}if(R(fe))return he.stylize(""+fe,"number");if(J(fe))return he.stylize(""+fe,"boolean");if(N(fe))return he.stylize("null","null")}(d,_);if(Se)return Se;var U=Object.keys(_),Y=function(he){var fe={};return he.forEach(function(Ee,ke){fe[Ee]=!0}),fe}(U);if(d.showHidden&&(U=Object.getOwnPropertyNames(_)),ne(_)&&(U.indexOf("message")>=0||U.indexOf("description")>=0))return $(_);if(U.length===0){if(ae(_)){var ue=_.name?": "+_.name:"";return d.stylize("[Function"+ue+"]","special")}if(g(_))return d.stylize(RegExp.prototype.toString.call(_),"regexp");if(K(_))return d.stylize(Date.prototype.toString.call(_),"date");if(ne(_))return $(_)}var Ae,Oe="",He=!1,nt=["{","}"];return q(_)&&(He=!0,nt=["[","]"]),ae(_)&&(Oe=" [Function"+(_.name?": "+_.name:"")+"]"),g(_)&&(Oe=" "+RegExp.prototype.toString.call(_)),K(_)&&(Oe=" "+Date.prototype.toUTCString.call(_)),ne(_)&&(Oe=" "+$(_)),U.length!==0||He&&_.length!=0?D<0?g(_)?d.stylize(RegExp.prototype.toString.call(_),"regexp"):d.stylize("[Object]","special"):(d.seen.push(_),Ae=He?function(he,fe,Ee,ke,Te){for(var Fe=[],De=0,Mt=fe.length;De<Mt;++De)Ne(fe,String(De))?Fe.push(P(he,fe,Ee,ke,String(De),!0)):Fe.push("");return Te.forEach(function(Ct){Ct.match(/^\d+$/)||Fe.push(P(he,fe,Ee,ke,Ct,!0))}),Fe}(d,_,D,Y,U):U.map(function(he){return P(d,_,D,Y,he,He)}),d.seen.pop(),function(he,fe,Ee){return he.reduce(function(ke,Te){return Te.indexOf(`
`)>=0,ke+Te.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?Ee[0]+(fe===""?"":fe+`
 `)+" "+he.join(`,
  `)+" "+Ee[1]:Ee[0]+fe+" "+he.join(", ")+" "+Ee[1]}(Ae,Oe,nt)):nt[0]+Oe+nt[1]}function $(d){return"["+Error.prototype.toString.call(d)+"]"}function P(d,_,D,oe,Se,U){var Y,ue,Ae;if((Ae=Object.getOwnPropertyDescriptor(_,Se)||{value:_[Se]}).get?ue=Ae.set?d.stylize("[Getter/Setter]","special"):d.stylize("[Getter]","special"):Ae.set&&(ue=d.stylize("[Setter]","special")),Ne(oe,Se)||(Y="["+Se+"]"),ue||(d.seen.indexOf(Ae.value)<0?(ue=N(D)?b(d,Ae.value,null):b(d,Ae.value,D-1)).indexOf(`
`)>-1&&(ue=U?ue.split(`
`).map(function(Oe){return"  "+Oe}).join(`
`).substr(2):`
`+ue.split(`
`).map(function(Oe){return"   "+Oe}).join(`
`)):ue=d.stylize("[Circular]","special")),c(Y)){if(U&&Se.match(/^\d+$/))return ue;(Y=JSON.stringify(""+Se)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Y=Y.substr(1,Y.length-2),Y=d.stylize(Y,"name")):(Y=Y.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Y=d.stylize(Y,"string"))}return Y+": "+ue}function q(d){return Array.isArray(d)}function J(d){return typeof d=="boolean"}function N(d){return d===null}function R(d){return typeof d=="number"}function s(d){return typeof d=="string"}function c(d){return d===void 0}function g(d){return j(d)&&me(d)==="[object RegExp]"}function j(d){return typeof d=="object"&&d!==null}function K(d){return j(d)&&me(d)==="[object Date]"}function ne(d){return j(d)&&(me(d)==="[object Error]"||d instanceof Error)}function ae(d){return typeof d=="function"}function me(d){return Object.prototype.toString.call(d)}function xe(d){return d<10?"0"+d.toString(10):d.toString(10)}f.debuglog=function(d){if(c(A)&&(A=w.env.NODE_DEBUG||""),d=d.toUpperCase(),!X[d])if(new RegExp("\\b"+d+"\\b","i").test(A)){var _=w.pid;X[d]=function(){var D=f.format.apply(f,arguments);console.error("%s %d: %s",d,_,D)}}else X[d]=function(){};return X[d]},f.inspect=y,y.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},y.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},f.isArray=q,f.isBoolean=J,f.isNull=N,f.isNullOrUndefined=function(d){return d==null},f.isNumber=R,f.isString=s,f.isSymbol=function(d){return typeof d=="symbol"},f.isUndefined=c,f.isRegExp=g,f.isObject=j,f.isDate=K,f.isError=ne,f.isFunction=ae,f.isPrimitive=function(d){return d===null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||typeof d=="symbol"||d===void 0},f.isBuffer=O(384);var Ce=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function pe(){var d=new Date,_=[xe(d.getHours()),xe(d.getMinutes()),xe(d.getSeconds())].join(":");return[d.getDate(),Ce[d.getMonth()],_].join(" ")}function Ne(d,_){return Object.prototype.hasOwnProperty.call(d,_)}f.log=function(){console.log("%s - %s",pe(),f.format.apply(f,arguments))},f.inherits=O(717),f._extend=function(d,_){if(!_||!j(_))return d;for(var D=Object.keys(_),oe=D.length;oe--;)d[D[oe]]=_[D[oe]];return d}}},V={};function z(I){var f=V[I];if(f!==void 0)return f.exports;var O=V[I]={exports:{}};return W[I].call(O.exports,O,O.exports,z),O.exports}z.n=I=>{var f=I&&I.__esModule?()=>I.default:()=>I;return z.d(f,{a:f}),f},z.d=(I,f)=>{for(var O in f)z.o(f,O)&&!z.o(I,O)&&Object.defineProperty(I,O,{enumerable:!0,get:f[O]})},z.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),z.o=(I,f)=>Object.prototype.hasOwnProperty.call(I,f),z.r=I=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})};var Z={};return(()=>{z.r(Z),z.d(Z,{LSPluginUser:()=>ar,setupPluginUserInstance:()=>qr});var I=z(520);z(856);const f=function(){this.__data__=[],this.size=0},O=function(t,e){return t===e||t!=t&&e!=e},w=function(t,e){for(var n=t.length;n--;)if(O(t[n][0],e))return n;return-1};var m=Array.prototype.splice;const A=function(t){var e=this.__data__,n=w(e,t);return!(n<0)&&(n==e.length-1?e.pop():m.call(e,n,1),--this.size,!0)},X=function(t){var e=this.__data__,n=w(e,t);return n<0?void 0:e[n][1]},y=function(t){return w(this.__data__,t)>-1},p=function(t,e){var n=this.__data__,r=w(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function v(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}v.prototype.clear=f,v.prototype.delete=A,v.prototype.get=X,v.prototype.has=y,v.prototype.set=p;const b=v,$=function(){this.__data__=new b,this.size=0},P=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},q=function(t){return this.__data__.get(t)},J=function(t){return this.__data__.has(t)},N=typeof Nn=="object"&&Nn&&Nn.Object===Object&&Nn;var R=typeof self=="object"&&self&&self.Object===Object&&self;const s=N||R||Function("return this")(),c=s.Symbol;var g=Object.prototype,j=g.hasOwnProperty,K=g.toString,ne=c?c.toStringTag:void 0;const ae=function(t){var e=j.call(t,ne),n=t[ne];try{t[ne]=void 0;var r=!0}catch{}var i=K.call(t);return r&&(e?t[ne]=n:delete t[ne]),i};var me=Object.prototype.toString;const xe=function(t){return me.call(t)};var Ce=c?c.toStringTag:void 0;const pe=function(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Ce&&Ce in Object(t)?ae(t):xe(t)},Ne=function(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")},d=function(t){if(!Ne(t))return!1;var e=pe(t);return e=="[object Function]"||e=="[object GeneratorFunction]"||e=="[object AsyncFunction]"||e=="[object Proxy]"},_=s["__core-js_shared__"];var D,oe=(D=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||""))?"Symbol(src)_1."+D:"";const Se=function(t){return!!oe&&oe in t};var U=Function.prototype.toString;const Y=function(t){if(t!=null){try{return U.call(t)}catch{}try{return t+""}catch{}}return""};var ue=/^\[object .+?Constructor\]$/,Ae=Function.prototype,Oe=Object.prototype,He=Ae.toString,nt=Oe.hasOwnProperty,he=RegExp("^"+He.call(nt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const fe=function(t){return!(!Ne(t)||Se(t))&&(d(t)?he:ue).test(Y(t))},Ee=function(t,e){return t?.[e]},ke=function(t,e){var n=Ee(t,e);return fe(n)?n:void 0},Te=ke(s,"Map"),Fe=ke(Object,"create"),De=function(){this.__data__=Fe?Fe(null):{},this.size=0},Mt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e};var Ct=Object.prototype.hasOwnProperty;const Pn=function(t){var e=this.__data__;if(Fe){var n=e[t];return n==="__lodash_hash_undefined__"?void 0:n}return Ct.call(e,t)?e[t]:void 0};var Rn=Object.prototype.hasOwnProperty;const Dn=function(t){var e=this.__data__;return Fe?e[t]!==void 0:Rn.call(e,t)},Un=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Fe&&e===void 0?"__lodash_hash_undefined__":e,this};function rt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}rt.prototype.clear=De,rt.prototype.delete=Mt,rt.prototype.get=Pn,rt.prototype.has=Dn,rt.prototype.set=Un;const ln=rt,zn=function(){this.size=0,this.__data__={hash:new ln,map:new(Te||b),string:new ln}},$n=function(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null},ft=function(t,e){var n=t.__data__;return $n(e)?n[typeof e=="string"?"string":"hash"]:n.map},S=function(t){var e=ft(this,t).delete(t);return this.size-=e?1:0,e},T=function(t){return ft(this,t).get(t)},B=function(t){return ft(this,t).has(t)},ee=function(t,e){var n=ft(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function ce(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ce.prototype.clear=zn,ce.prototype.delete=S,ce.prototype.get=T,ce.prototype.has=B,ce.prototype.set=ee;const Me=ce,Ke=function(t,e){var n=this.__data__;if(n instanceof b){var r=n.__data__;if(!Te||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Me(r)}return n.set(t,e),this.size=n.size,this};function Pe(t){var e=this.__data__=new b(t);this.size=e.size}Pe.prototype.clear=$,Pe.prototype.delete=P,Pe.prototype.get=q,Pe.prototype.has=J,Pe.prototype.set=Ke;const Ye=Pe,dt=function(){try{var t=ke(Object,"defineProperty");return t({},"",{}),t}catch{}}(),St=function(t,e,n){e=="__proto__"&&dt?dt(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Pt=function(t,e,n){(n!==void 0&&!O(t[e],n)||n===void 0&&!(e in t))&&St(t,e,n)},un=function(t){return function(e,n,r){for(var i=-1,a=Object(e),l=r(e),u=l.length;u--;){var h=l[t?u:++i];if(n(a[h],h,a)===!1)break}return e}}();var fn=E&&!E.nodeType&&E,pt=fn&&!0&&x&&!x.nodeType&&x,dn=pt&&pt.exports===fn?s.Buffer:void 0,pn=dn?dn.allocUnsafe:void 0;const qn=function(t,e){if(e)return t.slice();var n=t.length,r=pn?pn(n):new t.constructor(n);return t.copy(r),r},ot=s.Uint8Array,Rt=function(t){var e=new t.constructor(t.byteLength);return new ot(e).set(new ot(t)),e},Be=function(t,e){var n=e?Rt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)},hn=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e};var ht=Object.create;const Dt=function(){function t(){}return function(e){if(!Ne(e))return{};if(ht)return ht(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),gn=function(t,e){return function(n){return t(e(n))}},mn=gn(Object.getPrototypeOf,Object);var Hn=Object.prototype;const Ut=function(t){var e=t&&t.constructor;return t===(typeof e=="function"&&e.prototype||Hn)},vn=function(t){return typeof t.constructor!="function"||Ut(t)?{}:Dt(mn(t))},be=function(t){return t!=null&&typeof t=="object"},it=function(t){return be(t)&&pe(t)=="[object Arguments]"};var We=Object.prototype,zt=We.hasOwnProperty,$t=We.propertyIsEnumerable;const Ot=it(function(){return arguments}())?it:function(t){return be(t)&&zt.call(t,"callee")&&!$t.call(t,"callee")},Ie=Array.isArray,qt=function(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=9007199254740991},gt=function(t){return t!=null&&qt(t.length)&&!d(t)},Ht=function(t){return be(t)&&gt(t)},ve=function(){return!1};var Bt=E&&!E.nodeType&&E,ye=Bt&&!0&&x&&!x.nodeType&&x,Wt=ye&&ye.exports===Bt?s.Buffer:void 0;const le=(Wt?Wt.isBuffer:void 0)||ve;var mt=Function.prototype,Gt=Object.prototype,Jt=mt.toString,Vt=Gt.hasOwnProperty,yn=Jt.call(Object);const st=function(t){if(!be(t)||pe(t)!="[object Object]")return!1;var e=mn(t);if(e===null)return!0;var n=Vt.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Jt.call(n)==yn};var re={};re["[object Float32Array]"]=re["[object Float64Array]"]=re["[object Int8Array]"]=re["[object Int16Array]"]=re["[object Int32Array]"]=re["[object Uint8Array]"]=re["[object Uint8ClampedArray]"]=re["[object Uint16Array]"]=re["[object Uint32Array]"]=!0,re["[object Arguments]"]=re["[object Array]"]=re["[object ArrayBuffer]"]=re["[object Boolean]"]=re["[object DataView]"]=re["[object Date]"]=re["[object Error]"]=re["[object Function]"]=re["[object Map]"]=re["[object Number]"]=re["[object Object]"]=re["[object RegExp]"]=re["[object Set]"]=re["[object String]"]=re["[object WeakMap]"]=!1;const Zt=function(t){return be(t)&&qt(t.length)&&!!re[pe(t)]},Kt=function(t){return function(e){return t(e)}};var Qe=E&&!E.nodeType&&E,Ge=Qe&&!0&&x&&!x.nodeType&&x,at=Ge&&Ge.exports===Qe&&N.process,Yt=function(){try{var t=Ge&&Ge.require&&Ge.require("util").types;return t||at&&at.binding&&at.binding("util")}catch{}}(),Et=Yt&&Yt.isTypedArray;const Xe=Et?Kt(Et):Zt,Je=function(t,e){if((e!=="constructor"||typeof t[e]!="function")&&e!="__proto__")return t[e]};var ct=Object.prototype.hasOwnProperty;const bn=function(t,e,n){var r=t[e];ct.call(t,e)&&O(r,n)&&(n!==void 0||e in t)||St(t,e,n)},_n=function(t,e,n,r){var i=!n;n||(n={});for(var a=-1,l=e.length;++a<l;){var u=e[a],h=r?r(n[u],t[u],u,n,t):void 0;h===void 0&&(h=t[u]),i?St(n,u,h):bn(n,u,h)}return n},wn=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r};var Qt=/^(?:0|[1-9]\d*)$/;const kt=function(t,e){var n=typeof t;return!!(e=e??9007199254740991)&&(n=="number"||n!="symbol"&&Qt.test(t))&&t>-1&&t%1==0&&t<e};var Xt=Object.prototype.hasOwnProperty;const At=function(t,e){var n=Ie(t),r=!n&&Ot(t),i=!n&&!r&&le(t),a=!n&&!r&&!i&&Xe(t),l=n||r||i||a,u=l?wn(t.length,String):[],h=u.length;for(var L in t)!e&&!Xt.call(t,L)||l&&(L=="length"||i&&(L=="offset"||L=="parent")||a&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||kt(L,h))||u.push(L);return u},Ve=function(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e};var jt=Object.prototype.hasOwnProperty;const xn=function(t){if(!Ne(t))return Ve(t);var e=Ut(t),n=[];for(var r in t)(r!="constructor"||!e&&jt.call(t,r))&&n.push(r);return n},Cn=function(t){return gt(t)?At(t,!0):xn(t)},Bn=function(t){return _n(t,Cn(t))},lt=function(t,e,n,r,i,a,l){var u=Je(t,n),h=Je(e,n),L=l.get(h);if(L)Pt(t,n,L);else{var F=a?a(u,h,n+"",t,e,l):void 0,M=F===void 0;if(M){var H=Ie(h),Q=!H&&le(h),G=!H&&!Q&&Xe(h);F=h,H||Q||G?Ie(u)?F=u:Ht(u)?F=hn(u):Q?(M=!1,F=qn(h,!0)):G?(M=!1,F=Be(h,!0)):F=[]:st(h)||Ot(h)?(F=u,Ot(u)?F=Bn(u):Ne(u)&&!d(u)||(F=vn(h))):M=!1}M&&(l.set(h,F),i(F,h,r,a,l),l.delete(h)),Pt(t,n,F)}},Wn=function t(e,n,r,i,a){e!==n&&un(n,function(l,u){if(a||(a=new Ye),Ne(l))lt(e,n,u,r,t,i,a);else{var h=i?i(Je(e,u),l,u+"",e,n,a):void 0;h===void 0&&(h=l),Pt(e,u,h)}},Cn)},Tt=function(t){return t},en=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)};var tn=Math.max;const Sn=function(t,e,n){return e=tn(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,a=tn(r.length-e,0),l=Array(a);++i<a;)l[i]=r[e+i];i=-1;for(var u=Array(e+1);++i<e;)u[i]=r[i];return u[e]=n(l),en(t,this,u)}},Gn=function(t){return function(){return t}},It=dt?function(t,e){return dt(t,"toString",{configurable:!0,enumerable:!1,value:Gn(e),writable:!0})}:Tt;var nn=Date.now;const Jn=function(t){var e=0,n=0;return function(){var r=nn(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(It),Ue=function(t,e){return Jn(Sn(t,e,Tt),t+"")},On=function(t,e,n){if(!Ne(n))return!1;var r=typeof e;return!!(r=="number"?gt(n)&&kt(e,n.length):r=="string"&&e in n)&&O(n[e],t)},En=function(t){return Ue(function(e,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,l=i>2?n[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,l&&On(n[0],n[1],l)&&(a=i<3?void 0:a,i=1),e=Object(e);++r<i;){var u=n[r];u&&t(e,u,r,a)}return e})}(function(t,e,n){Wn(t,e,n)});var vt=function(){return vt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},vt.apply(this,arguments)};function Vn(t){return t.toLowerCase()}var yt=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],ze=/[^A-Z0-9]+/gi;function rn(t,e,n){return e instanceof RegExp?t.replace(e,n):e.reduce(function(r,i){return r.replace(i,n)},t)}function kn(t,e){return e===void 0&&(e={}),function(n,r){r===void 0&&(r={});for(var i=r.splitRegexp,a=i===void 0?yt:i,l=r.stripRegexp,u=l===void 0?ze:l,h=r.transform,L=h===void 0?Vn:h,F=r.delimiter,M=F===void 0?" ":F,H=rn(rn(n,a,"$1\0$2"),u,"\0"),Q=0,G=H.length;H.charAt(Q)==="\0";)Q++;for(;H.charAt(G-1)==="\0";)G--;return H.slice(Q,G).split("\0").map(L).join(M)}(t,vt({delimiter:"."},e))}var on=z(729),bt=z.n(on);function sn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const o=navigator.platform.toLowerCase()==="win32"?I.win32:I.posix,k=function(t,e){return e===void 0&&(e={}),kn(t,vt({delimiter:"_"},e))},C=En;class ie extends bt(){constructor(e,n){super(),sn(this,"_tag",void 0),sn(this,"_opts",void 0),sn(this,"_logs",[]),this._tag=e,this._opts=n}write(e,n,r){var i;n!=null&&n.length&&n[n.length-1]===!0&&(r=!0,n.pop());const a=n.reduce((u,h)=>(h&&h instanceof Error?u+=`${h.message} ${h.stack}`:u+=h.toString(),u),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var l;this._logs.push([e,a]),(r||(i=this._opts)!==null&&i!==void 0&&i.console)&&((l=console)===null||l===void 0||l[e==="ERROR"?"error":"debug"](`${e}: ${a}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...e){this.write("INFO",e)}error(...e){this.write("ERROR",e)}warn(...e){this.write("WARN",e)}setTag(e){this._tag=e}toJSON(){return this._logs}}function de(t,...e){try{const n=new URL(t);if(!n.origin)throw new Error(null);const r=o.join(t.substr(n.origin.length),...e);return n.origin+r}catch{return o.join(t,...e)}}function _e(t,e){let n,r,i=!1;const a=u=>h=>{t&&clearTimeout(t),u(h),i=!0},l=new Promise((u,h)=>{n=a(u),r=a(h),t&&(t=setTimeout(()=>r(new Error(`[deferred timeout] ${e}`)),t))});return{created:Date.now(),setTag:u=>e=u,resolve:n,reject:r,promise:l,get settled(){return i}}}const we=new Map;window.__injectedUIEffects=we;var _t=z(227),$e=z.n(_t);function te(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const et="application/x-postmate-v1+json";let dr=0;const Gr={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},Zn=(t,e)=>(typeof e!="string"||t.origin===e)&&!!t.data&&(typeof t.data!="object"||"postmate"in t.data)&&t.data.type===et&&!!Gr[t.data.postmate];class Jr{constructor(e){te(this,"parent",void 0),te(this,"frame",void 0),te(this,"child",void 0),te(this,"events",{}),te(this,"childOrigin",void 0),te(this,"listener",void 0),this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.listener=n=>{if(!Zn(n,this.childOrigin))return!1;const{data:r,name:i}=((n||{}).data||{}).value||{};n.data.postmate==="emit"&&i in this.events&&this.events[i].forEach(a=>{a.call(this,r)})},this.parent.addEventListener("message",this.listener,!1)}get(e,...n){return new Promise(r=>{const i=++dr,a=l=>{l.data.uid===i&&l.data.postmate==="reply"&&(this.parent.removeEventListener("message",a,!1),r(l.data.value))};this.parent.addEventListener("message",a,!1),this.child.postMessage({postmate:"request",type:et,property:e,args:n,uid:i},this.childOrigin)})}call(e,n){this.child.postMessage({postmate:"call",type:et,property:e,data:n},this.childOrigin)}on(e,n){this.events[e]||(this.events[e]=[]),this.events[e].push(n)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class Vr{constructor(e){te(this,"model",void 0),te(this,"parent",void 0),te(this,"parentOrigin",void 0),te(this,"child",void 0),this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",n=>{if(!Zn(n,this.parentOrigin))return;const{property:r,uid:i,data:a,args:l}=n.data;n.data.postmate!=="call"?((u,h,L)=>{const F=typeof u[h]=="function"?u[h].apply(null,L):u[h];return Promise.resolve(F)})(this.model,r,l).then(u=>{n.source.postMessage({property:r,postmate:"reply",type:et,uid:i,value:u},n.origin)}):r in this.model&&typeof this.model[r]=="function"&&this.model[r](a)})}emit(e,n){this.parent.postMessage({postmate:"emit",type:et,value:{name:e,data:n}},this.parentOrigin)}}class Kn{constructor(e){te(this,"container",void 0),te(this,"parent",void 0),te(this,"frame",void 0),te(this,"child",void 0),te(this,"childOrigin",void 0),te(this,"url",void 0),te(this,"model",void 0),this.container=e.container,this.url=e.url,this.parent=window,this.frame=document.createElement("iframe"),e.id&&(this.frame.id=e.id),e.name&&(this.frame.name=e.name),this.frame.classList.add.apply(this.frame.classList,e.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=e.model||{}}sendHandshake(e){const n=(a=>{const l=document.createElement("a");l.href=a;const u=l.protocol.length>4?l.protocol:window.location.protocol,h=l.host.length?l.port==="80"||l.port==="443"?l.hostname:l.host:window.location.host;return l.origin||`${u}//${h}`})(e=e||this.url);let r,i=0;return new Promise((a,l)=>{const u=L=>!!Zn(L,n)&&(L.data.postmate==="handshake-reply"?(clearInterval(r),this.parent.removeEventListener("message",u,!1),this.childOrigin=L.origin,a(new Jr(this))):l("Failed handshake"));this.parent.addEventListener("message",u,!1);const h=()=>{i++,this.child.postMessage({postmate:"handshake",type:et,model:this.model},n),i===5&&clearInterval(r)};this.frame.addEventListener("load",()=>{h(),r=setInterval(h,500)}),this.frame.src=e})}destroy(){this.frame.parentNode.removeChild(this.frame)}}te(Kn,"debug",!1),te(Kn,"Model",void 0);class Zr{constructor(e){te(this,"child",void 0),te(this,"model",void 0),te(this,"parent",void 0),te(this,"parentOrigin",void 0),this.child=window,this.model=e,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((e,n)=>{const r=i=>{if(i.data.postmate){if(i.data.postmate==="handshake"){this.child.removeEventListener("message",r,!1),i.source.postMessage({postmate:"handshake-reply",type:et},i.origin),this.parentOrigin=i.origin;const a=i.data.model;return a&&Object.keys(a).forEach(l=>{this.model[l]=a[l]}),e(new Vr(this))}return n("Handshake Reply Failed")}};this.child.addEventListener("message",r,!1)})}}function an(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const{importHTML:Kr,createSandboxContainer:Yr}=window.QSandbox||{};function Qr(t,e){return t.startsWith("http")?fetch(t,e):(t=t.replace("file://",""),new Promise(async(n,r)=>{try{const i=await window.apis.doAction(["readFile",t]);n({text:()=>i})}catch(i){console.error(i),r(i)}}))}class Xr extends bt(){constructor(e){super(),an(this,"_pluginLocal",void 0),an(this,"_frame",void 0),an(this,"_root",void 0),an(this,"_loaded",!1),an(this,"_unmountFns",[]),this._pluginLocal=e,e._dispose(()=>{this._unmount()})}async load(){const{name:e,entry:n}=this._pluginLocal.options;if(this.loaded||!n)return;const{template:r,execScripts:i}=await Kr(n,{fetch:Qr});this._mount(r,document.body);const a=Yr(e,{elementGetter:()=>{var u;return(u=this._root)===null||u===void 0?void 0:u.firstChild}}).instance.proxy;a.__shadow_mode__=!0,a.LSPluginLocal=this._pluginLocal,a.LSPluginShadow=this,a.LSPluginUser=a.logseq=new ar(this._pluginLocal.toJSON(),this._pluginLocal.caller);const l=await i(a,!0);this._unmountFns.push(l.unmount),this._loaded=!0}_mount(e,n){const r=this._frame=document.createElement("div");r.classList.add("lsp-shadow-sandbox"),r.id=this._pluginLocal.id,this._root=r.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${e}</div>`,n.appendChild(r),this.emit("mounted")}_unmount(){for(const e of this._unmountFns)e&&e.call(null)}destroy(){var e,n;(e=this.frame)===null||e===void 0||(n=e.parentNode)===null||n===void 0||n.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var e;return(e=this._root)===null||e===void 0?void 0:e.firstChild}get frame(){return this._frame}}function Ze(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const ut=$e()("LSPlugin:caller"),cn="#await#response#",eo="#lspmsg#",pr="#lspmsg#error#",An=t=>`#lspmsg#${t}`;class to extends bt(){constructor(e){super(),Ze(this,"_pluginLocal",void 0),Ze(this,"_connected",!1),Ze(this,"_parent",void 0),Ze(this,"_child",void 0),Ze(this,"_shadow",void 0),Ze(this,"_status",void 0),Ze(this,"_userModel",{}),Ze(this,"_call",void 0),Ze(this,"_callUserModel",void 0),Ze(this,"_debugTag",""),this._pluginLocal=e,e&&(this._debugTag=e.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:e}=this._pluginLocal;e?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(e={}){if(this._connected)return;const n=this,r=this._pluginLocal!=null;let i=0;const a=new Map,l=_e(6e4),u=this._extendUserModel({"#lspmsg#ready#":async F=>{u[An(F?.pid)]=({type:M,payload:H})=>{ut(`[host (_call) -> *user] ${this._debugTag}`,M,H),n.emit(M,H)},await l.resolve()},"#lspmsg#beforeunload#":async F=>{const M=_e(1e4);n.emit("beforeunload",Object.assign({actor:M},F)),await M.promise},"#lspmsg#settings#":async({type:F,payload:M})=>{n.emit("settings:changed",M)},[eo]:async({ns:F,type:M,payload:H})=>{ut(`[host (async) -> *user] ${this._debugTag} ns=${F} type=${M}`,H),F&&F.startsWith("hook")?n.emit(`${F}:${M}`,H):n.emit(M,H)},"#lspmsg#reply#":({_sync:F,result:M})=>{if(ut(`[sync host -> *user] #${F}`,M),a.has(F)){const H=a.get(F);H&&(M!=null&&M.hasOwnProperty(pr)?H.reject(M[pr]):H.resolve(M),a.delete(F))}},...e});var h;if(r)return await l.promise,JSON.parse(JSON.stringify((h=this._pluginLocal)===null||h===void 0?void 0:h.toJSON()));const L=new Zr(u).sendHandshakeReply();return this._status="pending",await L.then(F=>{this._child=F,this._connected=!0,this._call=async(M,H={},Q)=>{if(Q){const G=++i;a.set(G,Q),H._sync=G,Q.setTag(`async call #${G}`),ut(`async call #${G}`)}return F.emit(An(u.baseInfo.id),{type:M,payload:H}),Q?.promise},this._callUserModel=async(M,H)=>{try{u[M](H)}catch{ut(`[model method] #${M} not existed`)}},setInterval(()=>{if(a.size>100)for(const[M,H]of a)H.settled&&a.delete(M)},18e5)}).finally(()=>{this._status=void 0}),await l.promise,u.baseInfo}async call(e,n={}){var r;return(r=this._call)===null||r===void 0?void 0:r.call(this,e,n)}async callAsync(e,n={}){var r;const i=_e(1e4);return(r=this._call)===null||r===void 0?void 0:r.call(this,e,n,i)}async callUserModel(e,...n){var r;return(r=this._callUserModel)===null||r===void 0?void 0:r.apply(this,[e,...n])}async callUserModelAsync(e,...n){var r;return e=`${cn}${e}`,(r=this._callUserModel)===null||r===void 0?void 0:r.apply(this,[e,...n])}async _setupIframeSandbox(){const e=this._pluginLocal,n=e.id,r=`${n}_lsp_main`,i=new URL(e.options.entry);i.searchParams.set("__v__",e.options.version);const a=document.querySelector(`#${r}`);a&&a.parentElement.removeChild(a);const l=document.createElement("div");l.classList.add("lsp-iframe-sandbox-container"),l.id=r,l.dataset.pid=n;try{var u;const M=(u=await this._pluginLocal._loadLayoutsData())===null||u===void 0?void 0:u.$$0;if(M){l.dataset.inited_layout="true";let{width:H,height:Q,left:G,top:se,vw:ge,vh:je}=M;G=Math.max(G,0),G=typeof ge=="number"?`${Math.min(100*G/ge,99)}%`:`${G}px`,se=Math.max(se,45),se=typeof je=="number"?`${Math.min(100*se/je,99)}%`:`${se}px`,Object.assign(l.style,{width:H+"px",height:Q+"px",left:G,top:se})}}catch(M){console.error("[Restore Layout Error]",M)}document.body.appendChild(l);const h=new Kn({id:n+"_iframe",container:l,url:i.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(e.toJSON()))}});let L,F=h.sendHandshake();return this._status="pending",new Promise((M,H)=>{L=setTimeout(()=>{H(new Error("handshake Timeout")),h.destroy()},4e3),F.then(Q=>{this._parent=Q,this._connected=!0,this.emit("connected"),Q.on(An(e.id),({type:G,payload:se})=>{var ge,je;ut("[user -> *host] ",G,se),(ge=this._pluginLocal)===null||ge===void 0||ge.emit(G,se||{}),(je=this._pluginLocal)===null||je===void 0||je.caller.emit(G,se||{})}),this._call=async(...G)=>{await Q.call(An(e.id),{type:G[0],payload:Object.assign(G[1]||{},{$$pid:e.id})})},this._callUserModel=async(G,...se)=>{if(G.startsWith(cn))return await Q.get(G.replace(cn,""),...se);Q.call(G,se?.[0])},M(null)}).catch(Q=>{H(Q)}).finally(()=>{clearTimeout(L)})}).catch(M=>{throw ut("[iframe sandbox] error",M),M}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){const e=this._pluginLocal,n=this._shadow=new Xr(e);try{this._status="pending",await n.load(),this._connected=!0,this.emit("connected"),this._call=async(r,i={},a)=>{var l;return a&&(i.actor=a),(l=this._pluginLocal)===null||l===void 0||l.emit(r,Object.assign(i,{$$pid:e.id})),a?.promise},this._callUserModel=async(...r)=>{var i;let a=r[0];(i=a)!==null&&i!==void 0&&i.startsWith(cn)&&(a=a.replace(cn,""));const l=r[1]||{},u=this._userModel[a];typeof u=="function"&&await u.call(null,l)}}catch(r){throw ut("[shadow sandbox] error",r),r}finally{this._status=void 0}}_extendUserModel(e){return Object.assign(this._userModel,e)}_getSandboxIframeContainer(){var e;return(e=this._parent)===null||e===void 0?void 0:e.frame.parentNode}_getSandboxShadowContainer(){var e;return(e=this._shadow)===null||e===void 0?void 0:e.frame.parentNode}_getSandboxIframeRoot(){var e;return(e=this._parent)===null||e===void 0?void 0:e.frame}_getSandboxShadowRoot(){var e;return(e=this._shadow)===null||e===void 0?void 0:e.frame}set debugTag(e){this._debugTag=e}async destroy(){var e;let n=null;this._parent&&(n=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(n=this._getSandboxShadowContainer(),this._shadow.destroy()),(e=n)===null||e===void 0||e.parentNode.removeChild(n)}}function hr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class gr{constructor(e,n){hr(this,"ctx",void 0),hr(this,"opts",void 0),this.ctx=e,this.opts=n}get ctxId(){return this.ctx.baseInfo.id}setItem(e,n){var r;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,e,n,(r=this.opts)===null||r===void 0?void 0:r.assets]})}getItem(e){var n;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}removeItem(e){var n;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}allKeys(){var e;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(e=this.opts)===null||e===void 0?void 0:e.assets]})}clear(){var e;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(e=this.opts)===null||e===void 0?void 0:e.assets]})}hasItem(e){var n;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}}class no{constructor(e){var n,r,i;i=void 0,(r="ctx")in(n=this)?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,this.ctx=e}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(e,...n){var r,i;const a=this.ensureHostScope();return e=(r=k(e))===null||r===void 0?void 0:r.toLowerCase(),(i=a.logseq.api["exper_"+e])===null||i===void 0?void 0:i.apply(a,n)}async loadScripts(...e){(e=e.map(n=>n!=null&&n.startsWith("http")?n:this.ctx.resolveResourceFullUrl(n))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...e)}registerFencedCodeRenderer(e,n){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,e,n)}registerExtensionsEnhancer(e,n){const r=this.ensureHostScope();return e==="katex"&&r.katex&&n(r.katex).catch(console.error),r.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,e,n)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function Lt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const mr=t=>`task_callback_${t}`;class ro{constructor(e,n,r={}){Lt(this,"_client",void 0),Lt(this,"_requestId",void 0),Lt(this,"_requestOptions",void 0),Lt(this,"_promise",void 0),Lt(this,"_aborted",!1),this._client=e,this._requestId=n,this._requestOptions=r,this._promise=new Promise((u,h)=>{if(!this._requestId)return h(null);this._client.once(mr(this._requestId),L=>{L&&L instanceof Error?h(L):u(L)})});const{success:i,fail:a,final:l}=this._requestOptions;this._promise.then(u=>{i?.(u)}).catch(u=>{a?.(u)}).finally(()=>{l?.()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class Yn extends on.EventEmitter{constructor(e){super(),Lt(this,"_ctx",void 0),this._ctx=e,this.ctx.caller.on("#lsp#request#callback",n=>{const r=n?.requestId;r&&this.emit(mr(r),n?.payload)})}static createRequestTask(e,n,r){return new ro(e,n,r)}async _request(e){const n=this.ctx.baseInfo.id,{success:r,fail:i,final:a,...l}=e,u=this.ctx.Experiments.invokeExperMethod("request",n,l),h=Yn.createRequestTask(this.ctx.Request,u,e);return l.abortable?h:h.promise}get ctx(){return this._ctx}}const oo=gn(Object.keys,Object);var io=Object.prototype.hasOwnProperty;const so=function(t){if(!Ut(t))return oo(t);var e=[];for(var n in Object(t))io.call(t,n)&&n!="constructor"&&e.push(n);return e},Qn=function(t){return gt(t)?At(t):so(t)},ao=function(t,e){return t&&un(t,e,Qn)},co=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},lo=function(t){return this.__data__.has(t)};function jn(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Me;++e<n;)this.add(t[e])}jn.prototype.add=jn.prototype.push=co,jn.prototype.has=lo;const uo=jn,fo=function(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1},po=function(t,e){return t.has(e)},vr=function(t,e,n,r,i,a){var l=1&n,u=t.length,h=e.length;if(u!=h&&!(l&&h>u))return!1;var L=a.get(t),F=a.get(e);if(L&&F)return L==e&&F==t;var M=-1,H=!0,Q=2&n?new uo:void 0;for(a.set(t,e),a.set(e,t);++M<u;){var G=t[M],se=e[M];if(r)var ge=l?r(se,G,M,e,t,a):r(G,se,M,t,e,a);if(ge!==void 0){if(ge)continue;H=!1;break}if(Q){if(!fo(e,function(je,tt){if(!po(Q,tt)&&(G===je||i(G,je,n,r,a)))return Q.push(tt)})){H=!1;break}}else if(G!==se&&!i(G,se,n,r,a)){H=!1;break}}return a.delete(t),a.delete(e),H},ho=function(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n},go=function(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n};var yr=c?c.prototype:void 0,Xn=yr?yr.valueOf:void 0;const mo=function(t,e,n,r,i,a,l){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!a(new ot(t),new ot(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return O(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var u=ho;case"[object Set]":var h=1&r;if(u||(u=go),t.size!=e.size&&!h)return!1;var L=l.get(t);if(L)return L==e;r|=2,l.set(t,e);var F=vr(u(t),u(e),r,i,a,l);return l.delete(t),F;case"[object Symbol]":if(Xn)return Xn.call(t)==Xn.call(e)}return!1},vo=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t},yo=function(t,e,n){var r=e(t);return Ie(t)?r:vo(r,n(t))},bo=function(t,e){for(var n=-1,r=t==null?0:t.length,i=0,a=[];++n<r;){var l=t[n];e(l,n,t)&&(a[i++]=l)}return a},_o=function(){return[]};var wo=Object.prototype.propertyIsEnumerable,br=Object.getOwnPropertySymbols;const xo=br?function(t){return t==null?[]:(t=Object(t),bo(br(t),function(e){return wo.call(t,e)}))}:_o,_r=function(t){return yo(t,Qn,xo)};var Co=Object.prototype.hasOwnProperty;const So=function(t,e,n,r,i,a){var l=1&n,u=_r(t),h=u.length;if(h!=_r(e).length&&!l)return!1;for(var L=h;L--;){var F=u[L];if(!(l?F in e:Co.call(e,F)))return!1}var M=a.get(t),H=a.get(e);if(M&&H)return M==e&&H==t;var Q=!0;a.set(t,e),a.set(e,t);for(var G=l;++L<h;){var se=t[F=u[L]],ge=e[F];if(r)var je=l?r(ge,se,F,e,t,a):r(se,ge,F,t,e,a);if(!(je===void 0?se===ge||i(se,ge,n,r,a):je)){Q=!1;break}G||(G=F=="constructor")}if(Q&&!G){var tt=t.constructor,xt=e.constructor;tt==xt||!("constructor"in t)||!("constructor"in e)||typeof tt=="function"&&tt instanceof tt&&typeof xt=="function"&&xt instanceof xt||(Q=!1)}return a.delete(t),a.delete(e),Q},er=ke(s,"DataView"),tr=ke(s,"Promise"),nr=ke(s,"Set"),rr=ke(s,"WeakMap");var wr="[object Map]",xr="[object Promise]",Cr="[object Set]",Sr="[object WeakMap]",Or="[object DataView]",Oo=Y(er),Eo=Y(Te),ko=Y(tr),Ao=Y(nr),jo=Y(rr),wt=pe;(er&&wt(new er(new ArrayBuffer(1)))!=Or||Te&&wt(new Te)!=wr||tr&&wt(tr.resolve())!=xr||nr&&wt(new nr)!=Cr||rr&&wt(new rr)!=Sr)&&(wt=function(t){var e=pe(t),n=e=="[object Object]"?t.constructor:void 0,r=n?Y(n):"";if(r)switch(r){case Oo:return Or;case Eo:return wr;case ko:return xr;case Ao:return Cr;case jo:return Sr}return e});const Er=wt;var kr="[object Arguments]",Ar="[object Array]",Tn="[object Object]",jr=Object.prototype.hasOwnProperty;const To=function(t,e,n,r,i,a){var l=Ie(t),u=Ie(e),h=l?Ar:Er(t),L=u?Ar:Er(e),F=(h=h==kr?Tn:h)==Tn,M=(L=L==kr?Tn:L)==Tn,H=h==L;if(H&&le(t)){if(!le(e))return!1;l=!0,F=!1}if(H&&!F)return a||(a=new Ye),l||Xe(t)?vr(t,e,n,r,i,a):mo(t,e,h,n,r,i,a);if(!(1&n)){var Q=F&&jr.call(t,"__wrapped__"),G=M&&jr.call(e,"__wrapped__");if(Q||G){var se=Q?t.value():t,ge=G?e.value():e;return a||(a=new Ye),i(se,ge,n,r,a)}}return!!H&&(a||(a=new Ye),So(t,e,n,r,i,a))},Tr=function t(e,n,r,i,a){return e===n||(e==null||n==null||!be(e)&&!be(n)?e!=e&&n!=n:To(e,n,r,i,t,a))},Io=function(t,e,n,r){var i=n.length,a=i,l=!r;if(t==null)return!a;for(t=Object(t);i--;){var u=n[i];if(l&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<a;){var h=(u=n[i])[0],L=t[h],F=u[1];if(l&&u[2]){if(L===void 0&&!(h in t))return!1}else{var M=new Ye;if(r)var H=r(L,F,h,t,e,M);if(!(H===void 0?Tr(F,L,3,r,M):H))return!1}}return!0},Ir=function(t){return t==t&&!Ne(t)},Lo=function(t){for(var e=Qn(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Ir(i)]}return e},Lr=function(t,e){return function(n){return n!=null&&n[t]===e&&(e!==void 0||t in Object(n))}},No=function(t){var e=Lo(t);return e.length==1&&e[0][2]?Lr(e[0][0],e[0][1]):function(n){return n===t||Io(n,t,e)}},or=function(t){return typeof t=="symbol"||be(t)&&pe(t)=="[object Symbol]"};var Fo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mo=/^\w*$/;const ir=function(t,e){if(Ie(t))return!1;var n=typeof t;return!(n!="number"&&n!="symbol"&&n!="boolean"&&t!=null&&!or(t))||Mo.test(t)||!Fo.test(t)||e!=null&&t in Object(e)};function sr(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var l=t.apply(this,r);return n.cache=a.set(i,l)||a,l};return n.cache=new(sr.Cache||Me),n}sr.Cache=Me;const Po=sr;var Ro=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Do=/\\(\\)?/g;const Uo=function(t){var e=Po(t,function(r){return n.size===500&&n.clear(),r}),n=e.cache;return e}(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Ro,function(n,r,i,a){e.push(i?a.replace(Do,"$1"):r||n)}),e}),zo=function(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i};var Nr=c?c.prototype:void 0,Fr=Nr?Nr.toString:void 0;const $o=function t(e){if(typeof e=="string")return e;if(Ie(e))return zo(e,t)+"";if(or(e))return Fr?Fr.call(e):"";var n=e+"";return n=="0"&&1/e==-1/0?"-0":n},qo=function(t){return t==null?"":$o(t)},Mr=function(t,e){return Ie(t)?t:ir(t,e)?[t]:Uo(qo(t))},In=function(t){if(typeof t=="string"||or(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e},Pr=function(t,e){for(var n=0,r=(e=Mr(e,t)).length;t!=null&&n<r;)t=t[In(e[n++])];return n&&n==r?t:void 0},Ho=function(t,e,n){var r=t==null?void 0:Pr(t,e);return r===void 0?n:r},Bo=function(t,e){return t!=null&&e in Object(t)},Wo=function(t,e,n){for(var r=-1,i=(e=Mr(e,t)).length,a=!1;++r<i;){var l=In(e[r]);if(!(a=t!=null&&n(t,l)))break;t=t[l]}return a||++r!=i?a:!!(i=t==null?0:t.length)&&qt(i)&&kt(l,i)&&(Ie(t)||Ot(t))},Go=function(t,e){return t!=null&&Wo(t,e,Bo)},Jo=function(t,e){return ir(t)&&Ir(e)?Lr(In(t),e):function(n){var r=Ho(n,t);return r===void 0&&r===e?Go(n,t):Tr(e,r,3)}},Vo=function(t){return function(e){return e?.[t]}},Zo=function(t){return function(e){return Pr(e,t)}},Ko=function(t){return ir(t)?Vo(In(t)):Zo(t)},Yo=function(t){return typeof t=="function"?t:t==null?Tt:typeof t=="object"?Ie(t)?Jo(t[0],t[1]):No(t):Ko(t)},Qo=function(t,e){var n={};return e=Yo(e),ao(t,function(r,i,a){St(n,e(r,i,a),r)}),n};function Rr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Xo{constructor(e,n){Rr(this,"ctx",void 0),Rr(this,"serviceHooks",void 0),this.ctx=e,this.serviceHooks=n,e._execCallableAPI("register-search-service",e.baseInfo.id,n.name,n.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:r=>(Ie(r?.blocks)&&(r.blocks=r.blocks.map(i=>i&&Qo(i,(a,l)=>`block/${l}`))),r)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([r,i])=>{const a=(l=>`service:search:${l}:${n.name}`)(r);e.caller.on(a,async l=>{if(d(n?.[i.f])){let u=null;try{u=await n[i.f].apply(n,(i.args||[]).map(h=>{if(l){if(h===!0)return l;if(l.hasOwnProperty(h)){const L=l[h];return delete l[h],L}}})),i.transformOutput&&(u=i.transformOutput(u))}catch(h){console.error("[SearchService] ",h),u=h}finally{i.reply&&e.caller.call(`${a}:reply`,u)}}})})}}function qe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const ei=Symbol.for("proxy-continue"),ti=$e()("LSPlugin:user"),Dr=new ie("",{console:!0});function Nt(t,e,n){var r;if(typeof n!="function")return!1;const{key:i,label:a,desc:l,palette:u,keybinding:h,extras:L}=e,F=`SimpleCommandHook${i}${++$r}`;this.Editor["on"+F](n),(r=this.caller)===null||r===void 0||r.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:i,label:a,type:t,desc:l,keybinding:h,extras:L},["editor/hook",F]],u]})}function Ur(t){return!(typeof(e=t)!="string"||e.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e))||(Dr.error(`#${t} is not a valid UUID string.`),!1);var e}let Ln=null,zr=new Map;const ni={async getInfo(t){return Ln||(Ln=await this._execCallableAPIAsync("get-app-info")),typeof t=="string"?Ln[t]:Ln},registerCommand:Nt,registerSearchService(t){if(zr.has(t.name))throw new Error(`SearchService: #${t.name} has registered!`);zr.set(t.name,new Xo(this,t))},registerCommandPalette(t,e){const{key:n,label:r,keybinding:i}=t;return Nt.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:i},e)},registerCommandShortcut(t,e){const{binding:n}=t,r="$shortcut$",i=r+k(n);return Nt.call(this,r,{key:i,palette:!1,keybinding:t},e)},registerUIItem(t,e){var n;const r=this.baseInfo.id;(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-ui-item",args:[r,t,e]})},registerPageMenuItem(t,e){if(typeof e!="function")return!1;const n=t+"_"+this.baseInfo.id,r=t;Nt.call(this,"page-menu-item",{key:n,label:r},e)},onBlockRendererSlotted(t,e){if(!Ur(t))return;const n=this.baseInfo.id,r=`hook:editor:${k(`slot:${t}`)}`;return this.caller.on(r,e),this.App._installPluginHook(n,r),()=>{this.caller.off(r,e),this.App._uninstallPluginHook(n,r)}},invokeExternalPlugin(t,...e){var n;if(!(t=(n=t)===null||n===void 0?void 0:n.trim()))return;let[r,i]=t.split(".");if(!["models","commands"].includes(i?.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const a=t.replace(`${r}.${i}.`,"");if(!r||!i||!a)throw new Error(`Illegal type of #${t} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",r,i.toLowerCase(),a,e)},setFullScreen(t){const e=(...n)=>this._callWin("setFullScreen",...n);t==="toggle"?this._callWin("isFullScreen").then(n=>{n?e():e(!0)}):t?e(!0):e()}};let $r=0;const ri={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(t,e){var n;ti("Register slash command #",this.baseInfo.id,t,e),typeof e=="function"&&(e=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",e]]),e=e.map(r=>{const[i,...a]=r;if(i==="editor/hook"){let l=a[0],u=()=>{var L;(L=this.caller)===null||L===void 0||L.callUserModel(l)};typeof l=="function"&&(u=l);const h=`SlashCommandHook${i}${++$r}`;r[1]=h,this.Editor["on"+h](u)}return r}),(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[t,e]]})},registerBlockContextMenuItem(t,e){if(typeof e!="function")return!1;const n=t+"_"+this.baseInfo.id;Nt.call(this,"block-context-menu-item",{key:n,label:t},e)},registerHighlightContextMenuItem(t,e,n){if(typeof e!="function")return!1;const r=t+"_"+this.baseInfo.id;Nt.call(this,"highlight-context-menu-item",{key:r,label:t,extras:n},e)},scrollToBlockInPage(t,e,n){const r="block-content-"+e;n!=null&&n.replaceState?this.App.replaceState("page",{name:t},{anchor:r}):this.App.pushState("page",{name:t},{anchor:r})}},oi={onBlockChanged(t,e){if(!Ur(t))return;const n=this.baseInfo.id,r=`hook:db:${k(`block:${t}`)}`,i=({block:a,txData:l,txMeta:u})=>{a.uuid===t&&e(a,l,u)};return this.caller.on(r,i),this.App._installPluginHook(n,r),()=>{this.caller.off(r,i),this.App._uninstallPluginHook(n,r)}},datascriptQuery(t,...e){return e.pop(),e!=null&&e.some(n=>typeof n=="function")?this.Experiments.ensureHostScope().logseq.api.datascript_query(t,...e):this._execCallableAPIAsync("datascript_query",t,...e)}},ii={},si={},ai={makeSandboxStorage(){return new gr(this,{assets:!0})}};class ar extends bt(){constructor(e,n){super(),qe(this,"_baseInfo",void 0),qe(this,"_caller",void 0),qe(this,"_version","0.0.15"),qe(this,"_debugTag",""),qe(this,"_settingsSchema",void 0),qe(this,"_connected",!1),qe(this,"_ui",new Map),qe(this,"_mFileStorage",void 0),qe(this,"_mRequest",void 0),qe(this,"_mExperiments",void 0),qe(this,"_beforeunloadCallback",void 0),this._baseInfo=e,this._caller=n,n.on("sys:ui:visible",r=>{r!=null&&r.toggle&&this.toggleMainUI()}),n.on("settings:changed",r=>{const i=Object.assign({},this.settings),a=Object.assign(this._baseInfo.settings,r);this.emit("settings:changed",{...a},i)}),n.on("beforeunload",async r=>{const{actor:i,...a}=r,l=this._beforeunloadCallback;try{l&&await l(a),i?.resolve(null)}catch(u){console.debug(`${n.debugTag} [beforeunload] `,u),i?.reject(u)}})}async ready(e,n){if(!this._connected)try{var r;typeof e=="function"&&(n=e,e={});let i=await this._caller.connectToParent(e);this._connected=!0,i=C(this._baseInfo,i),(r=i)!==null&&r!==void 0&&r.id&&(this._debugTag=this._caller.debugTag=`#${i.id} [${i.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(i.settings=function(a,l){const u=(l||[]).reduce((h,L)=>("default"in L&&(h[L.key]=L.default),h),{});return Object.assign(u,a)}(i.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(a){console.warn(a)}n&&n.call(this,i)}catch(i){console.error(`${this._debugTag} [Ready Error]`,i)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(e){typeof e=="function"&&(this._beforeunloadCallback=e)}provideModel(e){return this.caller._extendUserModel(e),this}provideTheme(e){return this.caller.call("provider:theme",e),this}provideStyle(e){return this.caller.call("provider:style",e),this}provideUI(e){return this.caller.call("provider:ui",e),this}useSettingsSchema(e){return this.connected&&this.caller.call("settings:schema",{schema:e,isSync:!0}),this._settingsSchema=e,this}updateSettings(e){this.caller.call("settings:update",e)}onSettingsChanged(e){const n="settings:changed";return this.on(n,e),()=>this.off(n,e)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(e){this.caller.call("main-ui:attrs",e)}setMainUIInlineStyle(e){this.caller.call("main-ui:style",e)}hideMainUI(e){const n={key:0,visible:!1,cursor:e?.restoreEditingCursor};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}showMainUI(e){const n={key:0,visible:!0,autoFocus:e?.autoFocus};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}toggleMainUI(){const n=this._ui.get(0);n&&n.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const e=this._ui.get(0);return!!(e&&e.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(e=this)&&(((n=e.baseInfo)===null||n===void 0?void 0:n.effect)||!((r=e.baseInfo)!==null&&r!==void 0&&r.iir));var e,n,r}get logger(){return Dr}get settings(){var e;return(e=this.baseInfo)===null||e===void 0?void 0:e.settings}get caller(){return this._caller}resolveResourceFullUrl(e){if(this.ensureConnected(),e)return e=e.replace(/^[.\\/]+/,""),de(this._baseInfo.lsr,e)}_makeUserProxy(e,n){const r=this,i=this.caller;return new Proxy(e,{get(a,l,u){const h=a[l];return function(...L){if(h){const M=h.apply(r,L.concat(n));if(M!==ei)return M}if(n){const M=l.toString().match(/^(once|off|on)/i);if(M!=null){const H=M[0].toLowerCase(),Q=M.input.slice(H.length),G=H==="off",se=r.baseInfo.id,ge=`hook:${n}:${k(Q)}`,je=L[0],tt=L[1];i[H](ge,je);const xt=()=>{i.off(ge,je),i.listenerCount(ge)||r.App._uninstallPluginHook(se,ge)};return G?void xt():(r.App._installPluginHook(se,ge,tt),xt)}}let F=l;return["git","ui","assets"].includes(n)&&(F=n+"_"+F),i.callAsync("api:call",{tag:n,method:F,args:L})}}})}_execCallableAPIAsync(e,...n){return this._caller.callAsync("api:call",{method:e,args:n})}_execCallableAPI(e,...n){this._caller.call("api:call",{method:e,args:n})}_callWin(...e){return this._execCallableAPIAsync("_callMainWin",...e)}get App(){return this._makeUserProxy(ni,"app")}get Editor(){return this._makeUserProxy(ri,"editor")}get DB(){return this._makeUserProxy(oi,"db")}get Git(){return this._makeUserProxy(ii,"git")}get UI(){return this._makeUserProxy(si,"ui")}get Assets(){return this._makeUserProxy(ai,"assets")}get FileStorage(){let e=this._mFileStorage;return e||(e=this._mFileStorage=new gr(this)),e}get Request(){let e=this._mRequest;return e||(e=this._mRequest=new Yn(this)),e}get Experiments(){let e=this._mExperiments;return e||(e=this._mExperiments=new no(this)),e}}function qr(t,e){return new ar(t,e)}if(window.__LSP__HOST__==null){const t=new to(null);window.logseq=qr({},t)}})(),Z})())})(Fn,Fn.exports);Fn.exports;const ci={id:"logseq13-shorten-my-links",title:"Shorten My Links",icon:"./icon.png",main:"./dist/index.html"};function lr(x,...E){const W=String.raw({raw:x},...E),V=W?" ":"";return`#${ci.id}:${V}${W}`}function Hr(x){return new Promise(E=>setTimeout(E,x))}function li(x,E){return E.length===0?0:(x.length-x.replaceAll(E,"").length)/E.length}function ui(x,E,W=1){if(W<=0)throw new Error("count param should be positive");const V=li(x,E);return W>V?null:x.split(E,W).join(E).length}async function fi(){const x=await logseq.Editor.getSelectedBlocks()??[],E=await logseq.Editor.checkEditing();if(!E&&x.length===0)return null;const W=x.length!==0;return[W?x[0].uuid:E,W]}async function cr(x,E={}){const W=await fi();if(!W)return console.warn(lr`Attempt to insert content while not in editing state and no one block is selected`),!1;const[V,z]=W,{positionOnNthText:Z,positionBeforeText:I,positionAfterText:f,positionIndex:O}=E;let w;if(Z){const{text:m,count:A}=Z;w=ui(x,m,A)??x.length}else if(I){const m=x.indexOf(I);m!==-1&&(w=m)}else if(f){const m=x.indexOf(f);m!==-1&&(w=m+f.length)}else if(O){const m=ur(O,x.length);m<x.length&&(w=m)}if(z)await logseq.Editor.updateBlock(V,x),w!==void 0&&await logseq.Editor.editBlock(V,{pos:w});else if(await logseq.Editor.insertAtEditingCursor(x),w!==void 0){await Hr(20);const m=await logseq.Editor.getEditingCursorPosition(),A=m.pos-x.length+w;console.debug(lr`Calculating arg position`,m.pos,"-",x.length,"+",w,"===",A),di(A)||(await logseq.Editor.exitEditingMode(),await Hr(20),await logseq.Editor.editBlock(V,{pos:A}))}return!0}function di(x){return hi(x,x)}function ur(x,E){return x>E&&(x=E),x<-E-1&&(x=-E-1),x<0&&(x+=E+1),x}function pi(){const x=top.document.getElementsByClassName("editor-wrapper")[0];if(!x)return null;const E=top.document.getElementById(x.id.replace(/^editor-/,""));return E||null}function hi(x,E){const W=pi();if(!W)return!1;const V=W.value.length;return x=ur(x,V),E=ur(E,V),W.selectionStart=x,W.selectionEnd=E,!0}function fr(x,E){const{toOrig:W}=E;let V="";if(W?V=x.dataset.origText??"":V=x.dataset.abbreviatedText??"",!V)return;const z=x.classList.contains("tag"),Z=Mn(x);Z&&(Z.textContent=(z?"#":"")+V)}function Mn(x){let E;return x.childNodes.forEach(W=>{W.nodeType===document.TEXT_NODE&&(E=W)}),E}function gi(x,E){E=E.toLowerCase();const W=x.split("/");for(let V=1;V<W.length;V++){const z=W.slice(0,-V).join("/");if(z.toLowerCase()===E)return[z,W.slice(-V).join("/")]}return[void 0,void 0]}function mi(x,E){for(const[W,V,z]of E){const Z=x.closest(W);if(!Z)continue;const I=Z?.querySelector(V);if(!I||I===x)continue;if(I.dataset.origText)return I.dataset.origText;const f=Mn(I)?.textContent;if(!f)return;let O="";return z&&top.document.querySelectorAll(z).forEach(w=>{const m=Mn(w)?.textContent??"";m&&(O+=m+"/")}),O+f}}function vi(x){for(const E of Object.keys(Br))if(x.closest(E))return Br[E];return null}function yi(){function x(V){const z=V.target.parentElement;z&&(V.type==="mouseenter"?fr(z,{toOrig:!0}):V.type==="mouseleave"&&fr(z,{toOrig:!1}))}function E(V,z){for(const[I,f]of z)for(const O of V.querySelectorAll(I)){const w=O;if(w.dataset.abbreviatedText)continue;const m=Mn(w);let A=m?.textContent??"";if(A.indexOf("/")<0)continue;const X=w.classList.contains("tag");if(A=X?A.substring(1):A,w.dataset.ref&&w.dataset.ref.toLowerCase()!==A.toLowerCase())continue;const y=mi(w,f);if(!y)continue;const[p,v]=gi(A,y);if(!v)continue;w.dataset.origText=A,w.dataset.abbreviatedText=v,m.textContent=X?"#"+v:v;var Z=top.document.createElement("span");Z.innerText=" ",Z.classList.add(Wr),Z.onmouseenter=x,Z.onmouseleave=x;const b=w.childNodes[0];(b.className??"").split(" ").includes("bracket")?b.insertAdjacentElement("afterend",Z):w.insertAdjacentElement("afterbegin",Z)}}const W=V=>{for(const z of V)for(const Z of z.addedNodes){const I=Z;if(!I.querySelectorAll||I.classList.contains("awLi-icon")||I.classList.contains("awLi-favicon"))continue;const f=vi(I);f&&E(I,f)}};return new MutationObserver(W)}const Wr="shml-anchor",Re=['a.page-ref[data-ref*="/"]','a.tag[data-ref*="/"]'],Ft=[".breadcrumb span.inline-wrap > span.page-reference"],Le=(x,E)=>E.map(W=>x+" "+W).join(", "),Br={".cp__sidebar-main-content":[[Le("div.references.page-tags",Re),[["div.page","div.ls-page-title span.title[data-ref]","#hierarchyLinks > a.page-ref"]]],[Le("#today-queries",Re.concat(Ft)),[["div.content > div > div.lazy-visibility","div.content a.page-ref"]]],[Le("div.scheduled-or-deadlines",Re),[["div.content > div > div.lazy-visibility","div.content a.page-ref"]]],[Le("div.references.page-linked div.foldable-title",Re),[["div.page","div.ls-page-title span.title[data-ref]","#hierarchyLinks > a.page-ref"]]],[Le("div.references.page-linked div.blocks-container",Re.concat(Ft)),[["div.content > div > div.lazy-visibility","div.content a.page-ref"]]],[Le("div.page > div:first-child",Re),[["div.embed-page","section a.page-ref"],["div.content > div > div.lazy-visibility","a.page-ref"],["div.page > div:first-child","div.ls-page-title span.title[data-ref]","#hierarchyLinks > a.page-ref"],["div.page > div:first-child","div.breadcrumb a.page-ref"]]],[Le("div.page > div:first-child",Ft),[["div.content > div > div.lazy-visibility","a.page-ref"],["div.breadcrumb","a.page-ref"]]]],"#right-sidebar":[[Le("div.custom-query-results",Re.concat(Ft)),[["div.content > div > div.lazy-visibility","div.content a.page-ref"]]],[Le("div.references.page-tags",Re),[["div.sidebar-item","div.page-title > span.text-ellipsis"]]],[Le("div.scheduled-or-deadlines",Re),[["div.content > div > div.lazy-visibility","div.content a.page-ref"]]],[Le("div.references.page-linked div.foldable-title",Re),[["div.sidebar-item","div.page-title > span.text-ellipsis"]]],[Le("div.references.page-linked div.blocks-container",Re.concat(Ft)),[["div.content > div > div.lazy-visibility","div.content a.page-ref"]]],[Le("div.page > div:first-child",Re),[["div.embed-page","section a.page-ref"],["div.sidebar-item","div.page-title > span.text-ellipsis"],["div.sidebar-item","div.breadcrumb a.page-ref"]]],[Le("",Ft),[["div.sidebar-item","div.page-title > span.text-ellipsis"],["div.sidebar-item","div.breadcrumb a.page-ref"]]]]};function bi(){top.document.querySelectorAll("."+Wr).forEach(x=>{const E=x.parentElement;E.removeChild(x),E.dataset.origText&&(fr(E,{toOrig:!0}),delete E.dataset.origText),E.dataset.abbreviatedText&&delete E.dataset.abbreviatedText})}function _i(){const x=yi(),E={start:()=>{const W=top.document.querySelector("#app-container");if(!W){setTimeout(()=>E.start(),500);return}x.observe(W,{subtree:!0,childList:!0})},stop:()=>{x.disconnect(),bi()}};return E}const wi=async()=>{console.log(lr`loaded`);const x=_i();setTimeout(()=>x.start(),1e3),logseq.beforeunload(async()=>{x.stop()}),logseq.Editor.registerSlashCommand("Reference to ./sub-page",async E=>{const W=await logseq.Editor.getCurrentBlock(),Z=`${(await logseq.Editor.getPage(W.page.id)).originalName}/`;await cr(`[[${Z}]]`,{positionIndex:-3})}),logseq.Editor.registerSlashCommand("Reference to ../sibling-page",async E=>{const W=await logseq.Editor.getCurrentBlock(),z=(await logseq.Editor.getPage(W.page.id)).originalName;if(z.indexOf("/")===-1){await cr("[[]]",{positionIndex:-3});return}const Z=z.split("/");Z.pop();const I=Z.join("/");await cr(`[[${I}/]]`,{positionIndex:-3})}),await xi()};function xi(){logseq.settings.notifications||(logseq.settings.notifications={});const x=logseq.settings.notifications.previousPluginVersion,E=logseq.baseInfo.version;E!==x&&(logseq.settings.notifications.introducedSubPagesCommand||(logseq.UI.showMsg(`[:div
                    [:p [:code " Shorten My Links"] [:br]
                        [:p [:i "The fast way of referencing sub pages"]]
                        [:p "Just type-in " [:code "/."] " and select " [:br]
                            [:code "Reference to ./sub-page"] " or " [:br]
                            [:code "Reference to ../sibling-page"] ]]
                    [:p "See details "
                        [:a {:href "https://github.com/stdword/logseq13-shorten-my-links#2-to-have-a-very-fast-way-of-creating-or-referencing-sub-pages"}
                            "here"] "."]
                ]`,"info",{timeout:6e4}),logseq.updateSettings({notifications:{introducedSubPagesCommand:!0}}))),logseq.updateSettings({notifications:{previousPluginVersion:E}})}logseq.ready(wi).catch(console.error);
